训练配置: {'use_valid_edge': False, 'use_ayscn_prefetch': True, 'pre_sample_size': 600000, 'part_neg_sample': False}
Sent: init_feats
Received: None
Epoch 0:
IO load: 0.000s presample and analyze: 0.000s 预采样: 0.000s, 预采样负采样:0.000s
第一个块的加载时间: 1.614s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.282s 异步阻塞: 0.000s presample and analyze: 1.347s 预采样: 0.000s, 预采样负采样:0.033s              记忆刷入和更新:0.239s 纯刷入时间:0.000s 负采样分析: 1.075s
平均每个batch用时0.02432s, 预计epoch时间: 66.686s
run batch1000total time: 24.32s,presample: 2.38s, sample: 0.55s, prep time: 5.02s, gen block: 2.08s, feat input: 1.15s, model run: 4.70s,                    loss and opt: 10.92s, update mem: 0.62s update mailbox: 0.83s
feat_buffer time: IO load: 0.972s 异步阻塞: 0.001s presample and analyze: 1.406s 预采样: 0.000s, 预采样负采样:0.090s              记忆刷入和更新:0.239s 纯刷入时间:0.000s 负采样分析: 1.075s
平均每个batch用时0.02255s, 预计epoch时间: 61.821s
run batch2000total time: 46.87s,presample: 3.23s, sample: 1.11s, prep time: 10.27s, gen block: 4.25s, feat input: 2.38s, model run: 8.48s,                    loss and opt: 22.26s, update mem: 1.28s update mailbox: 1.68s
feat_buffer time: IO load: 1.758s 异步阻塞: 0.001s presample and analyze: 1.461s 预采样: 0.000s, 预采样负采样:0.144s              记忆刷入和更新:0.239s 纯刷入时间:0.000s 负采样分析: 1.075s
total loop use time: 64.0727
run batch2741total time: 63.67s,presample: 3.88s, sample: 1.52s, prep time: 14.14s, gen block: 5.84s, feat input: 3.28s, model run: 11.28s,               loss and opt: 30.76s, update mem: 1.77s update mailbox: 2.32s
	train loss:3583800.5709  val ap:0.933669  val auc:0.926859, eval time: 30.34
Epoch 1:
IO load: 2.383s presample and analyze: 1.484s 预采样: 0.000s, 预采样负采样:0.166s
第一个块的加载时间: 0.709s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.352s 异步阻塞: 0.000s presample and analyze: 0.374s 预采样: 0.000s, 预采样负采样:0.034s              记忆刷入和更新:0.254s 纯刷入时间:0.000s 负采样分析: 0.086s
平均每个batch用时0.02279s, 预计epoch时间: 62.488s
run batch1000total time: 22.79s,presample: 1.33s, sample: 0.55s, prep time: 5.12s, gen block: 2.11s, feat input: 1.20s, model run: 3.77s,                    loss and opt: 11.25s, update mem: 0.63s update mailbox: 0.84s
feat_buffer time: IO load: 0.904s 异步阻塞: 0.000s presample and analyze: 0.427s 预采样: 0.000s, 预采样负采样:0.085s              记忆刷入和更新:0.254s 纯刷入时间:0.000s 负采样分析: 0.086s
平均每个batch用时0.02207s, 预计epoch时间: 60.505s
run batch2000total time: 44.86s,presample: 1.98s, sample: 1.10s, prep time: 10.29s, gen block: 4.25s, feat input: 2.42s, model run: 7.57s,                    loss and opt: 22.40s, update mem: 1.26s update mailbox: 1.68s
feat_buffer time: IO load: 1.488s 异步阻塞: 0.001s presample and analyze: 0.480s 预采样: 0.000s, 预采样负采样:0.137s              记忆刷入和更新:0.254s 纯刷入时间:0.000s 负采样分析: 0.086s
total loop use time: 61.5459
run batch2741total time: 61.11s,presample: 2.47s, sample: 1.51s, prep time: 14.10s, gen block: 5.82s, feat input: 3.32s, model run: 10.35s,               loss and opt: 30.60s, update mem: 1.73s update mailbox: 2.29s
	train loss:3153242.9060  val ap:0.946775  val auc:0.940086, eval time: 32.03
Epoch 2:
IO load: 1.958s presample and analyze: 0.502s 预采样: 0.000s, 预采样负采样:0.158s
第一个块的加载时间: 0.763s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.411s 异步阻塞: 0.000s presample and analyze: 0.370s 预采样: 0.000s, 预采样负采样:0.035s              记忆刷入和更新:0.248s 纯刷入时间:0.000s 负采样分析: 0.087s
平均每个batch用时0.02362s, 预计epoch时间: 64.748s
run batch1000total time: 23.62s,presample: 1.56s, sample: 0.57s, prep time: 5.27s, gen block: 2.18s, feat input: 1.21s, model run: 3.83s,                    loss and opt: 11.59s, update mem: 0.66s update mailbox: 0.88s
feat_buffer time: IO load: 1.132s 异步阻塞: 0.000s presample and analyze: 0.425s 预采样: 0.000s, 预采样负采样:0.088s              记忆刷入和更新:0.248s 纯刷入时间:0.000s 负采样分析: 0.087s
平均每个batch用时0.02236s, 预计epoch时间: 61.315s
run batch2000total time: 45.98s,presample: 2.38s, sample: 1.11s, prep time: 10.43s, gen block: 4.30s, feat input: 2.41s, model run: 7.58s,                    loss and opt: 22.91s, update mem: 1.30s update mailbox: 1.73s
feat_buffer time: IO load: 1.896s 异步阻塞: 0.001s presample and analyze: 0.478s 预采样: 0.000s, 预采样负采样:0.140s              记忆刷入和更新:0.248s 纯刷入时间:0.000s 负采样分析: 0.087s
total loop use time: 63.2556
run batch2741total time: 62.75s,presample: 3.02s, sample: 1.53s, prep time: 14.31s, gen block: 5.90s, feat input: 3.31s, model run: 10.40s,               loss and opt: 31.38s, update mem: 1.79s update mailbox: 2.36s
	train loss:3042686.9568  val ap:0.951779  val auc:0.945900, eval time: 34.36
Epoch 3:
IO load: 2.507s presample and analyze: 0.501s 预采样: 0.000s, 预采样负采样:0.162s
第一个块的加载时间: 0.734s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.382s 异步阻塞: 0.000s presample and analyze: 0.371s 预采样: 0.000s, 预采样负采样:0.034s              记忆刷入和更新:0.248s 纯刷入时间:0.000s 负采样分析: 0.088s
平均每个batch用时0.02350s, 预计epoch时间: 64.437s
run batch1000total time: 23.50s,presample: 1.36s, sample: 0.58s, prep time: 5.29s, gen block: 2.19s, feat input: 1.23s, model run: 3.92s,                    loss and opt: 11.57s, update mem: 0.65s update mailbox: 0.87s
feat_buffer time: IO load: 0.928s 异步阻塞: 0.000s presample and analyze: 0.423s 预采样: 0.000s, 预采样负采样:0.085s              记忆刷入和更新:0.248s 纯刷入时间:0.000s 负采样分析: 0.088s
平均每个batch用时0.02186s, 预计epoch时间: 59.926s
run batch2000total time: 45.36s,presample: 1.99s, sample: 1.13s, prep time: 10.40s, gen block: 4.30s, feat input: 2.44s, model run: 7.66s,                    loss and opt: 22.65s, update mem: 1.28s update mailbox: 1.69s
feat_buffer time: IO load: 1.505s 异步阻塞: 0.001s presample and analyze: 0.475s 预采样: 0.000s, 预采样负采样:0.136s              记忆刷入和更新:0.248s 纯刷入时间:0.000s 负采样分析: 0.088s
total loop use time: 62.0902
run batch2741total time: 61.59s,presample: 2.47s, sample: 1.53s, prep time: 14.19s, gen block: 5.86s, feat input: 3.34s, model run: 10.43s,               loss and opt: 30.87s, update mem: 1.74s update mailbox: 2.31s
	train loss:2989145.2083  val ap:0.949492  val auc:0.942913, eval time: 27.65
Epoch 4:
IO load: 1.962s presample and analyze: 0.496s 预采样: 0.000s, 预采样负采样:0.157s
第一个块的加载时间: 0.756s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.411s 异步阻塞: 0.000s presample and analyze: 0.364s 预采样: 0.000s, 预采样负采样:0.035s              记忆刷入和更新:0.243s 纯刷入时间:0.000s 负采样分析: 0.085s
平均每个batch用时0.02243s, 预计epoch时间: 61.500s
run batch1000total time: 22.43s,presample: 1.37s, sample: 0.54s, prep time: 5.04s, gen block: 2.09s, feat input: 1.18s, model run: 3.69s,                    loss and opt: 11.05s, update mem: 0.62s update mailbox: 0.82s
feat_buffer time: IO load: 0.948s 异步阻塞: 0.000s presample and analyze: 0.414s 预采样: 0.000s, 预采样负采样:0.084s              记忆刷入和更新:0.243s 纯刷入时间:0.000s 负采样分析: 0.085s
平均每个batch用时0.02155s, 预计epoch时间: 59.090s
run batch2000total time: 43.98s,presample: 1.99s, sample: 1.08s, prep time: 10.06s, gen block: 4.16s, feat input: 2.37s, model run: 7.36s,                    loss and opt: 22.01s, update mem: 1.24s update mailbox: 1.64s
feat_buffer time: IO load: 1.520s 异步阻塞: 0.001s presample and analyze: 0.466s 预采样: 0.000s, 预采样负采样:0.135s              记忆刷入和更新:0.243s 纯刷入时间:0.000s 负采样分析: 0.085s
total loop use time: 60.5214
run batch2741total time: 60.07s,presample: 2.47s, sample: 1.48s, prep time: 13.81s, gen block: 5.71s, feat input: 3.26s, model run: 10.11s,               loss and opt: 30.17s, update mem: 1.70s update mailbox: 2.25s
	train loss:2944214.8072  val ap:0.950160  val auc:0.944105, eval time: 27.26
Epoch 5:
IO load: 1.973s presample and analyze: 0.489s 预采样: 0.000s, 预采样负采样:0.156s
第一个块的加载时间: 0.629s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.298s 异步阻塞: 0.000s presample and analyze: 0.346s 预采样: 0.000s, 预采样负采样:0.028s              记忆刷入和更新:0.233s 纯刷入时间:0.000s 负采样分析: 0.084s
平均每个batch用时0.02190s, 预计epoch时间: 60.040s
run batch1000total time: 21.90s,presample: 1.25s, sample: 0.53s, prep time: 4.98s, gen block: 2.06s, feat input: 1.16s, model run: 3.64s,                    loss and opt: 10.76s, update mem: 0.62s update mailbox: 0.81s
feat_buffer time: IO load: 0.851s 异步阻塞: 0.000s presample and analyze: 0.398s 预采样: 0.000s, 预采样负采样:0.079s              记忆刷入和更新:0.233s 纯刷入时间:0.000s 负采样分析: 0.084s
平均每个batch用时0.02172s, 预计epoch时间: 59.536s
run batch2000total time: 43.61s,presample: 1.90s, sample: 1.07s, prep time: 10.03s, gen block: 4.14s, feat input: 2.36s, model run: 7.33s,                    loss and opt: 21.81s, update mem: 1.24s update mailbox: 1.63s
feat_buffer time: IO load: 1.439s 异步阻塞: 0.001s presample and analyze: 0.451s 预采样: 0.000s, 预采样负采样:0.130s              记忆刷入和更新:0.233s 纯刷入时间:0.000s 负采样分析: 0.084s
total loop use time: 60.1845
run batch2741total time: 59.77s,presample: 2.39s, sample: 1.48s, prep time: 13.79s, gen block: 5.69s, feat input: 3.25s, model run: 10.14s,               loss and opt: 29.95s, update mem: 1.70s update mailbox: 2.24s
	train loss:2920780.1148  val ap:0.949949  val auc:0.943408, eval time: 28.83
Epoch 6:
IO load: 1.904s presample and analyze: 0.474s 预采样: 0.000s, 预采样负采样:0.153s
第一个块的加载时间: 0.699s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.331s 异步阻塞: 0.000s presample and analyze: 0.384s 预采样: 0.000s, 预采样负采样:0.032s              记忆刷入和更新:0.262s 纯刷入时间:0.000s 负采样分析: 0.089s
平均每个batch用时0.02229s, 预计epoch时间: 61.102s
run batch1000total time: 22.29s,presample: 1.33s, sample: 0.54s, prep time: 5.05s, gen block: 2.10s, feat input: 1.19s, model run: 3.68s,                    loss and opt: 10.95s, update mem: 0.61s update mailbox: 0.82s
feat_buffer time: IO load: 0.885s 异步阻塞: 0.000s presample and analyze: 0.436s 预采样: 0.000s, 预采样负采样:0.083s              记忆刷入和更新:0.262s 纯刷入时间:0.000s 负采样分析: 0.089s
平均每个batch用时0.02177s, 预计epoch时间: 59.674s
run batch2000total time: 44.05s,presample: 1.97s, sample: 1.09s, prep time: 10.14s, gen block: 4.20s, feat input: 2.39s, model run: 7.38s,                    loss and opt: 22.00s, update mem: 1.24s update mailbox: 1.64s
feat_buffer time: IO load: 1.472s 异步阻塞: 0.001s presample and analyze: 0.489s 预采样: 0.000s, 预采样负采样:0.134s              记忆刷入和更新:0.262s 纯刷入时间:0.000s 负采样分析: 0.089s
total loop use time: 60.6127
run batch2741total time: 60.21s,presample: 2.46s, sample: 1.49s, prep time: 13.92s, gen block: 5.77s, feat input: 3.28s, model run: 10.14s,               loss and opt: 30.16s, update mem: 1.71s update mailbox: 2.25s
	train loss:2909490.9283  val ap:0.951270  val auc:0.944886, eval time: 27.39
Epoch 7:
IO load: 1.938s presample and analyze: 0.512s 预采样: 0.000s, 预采样负采样:0.156s
第一个块的加载时间: 0.832s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.436s 异步阻塞: 0.000s presample and analyze: 0.414s 预采样: 0.000s, 预采样负采样:0.035s              记忆刷入和更新:0.282s 纯刷入时间:0.000s 负采样分析: 0.096s
平均每个batch用时0.02264s, 预计epoch时间: 62.070s
run batch1000total time: 22.64s,presample: 1.49s, sample: 0.56s, prep time: 5.12s, gen block: 2.12s, feat input: 1.20s, model run: 3.78s,                    loss and opt: 10.95s, update mem: 0.63s update mailbox: 0.83s
feat_buffer time: IO load: 1.018s 异步阻塞: 0.000s presample and analyze: 0.466s 预采样: 0.000s, 预采样负采样:0.086s              记忆刷入和更新:0.282s 纯刷入时间:0.000s 负采样分析: 0.096s
平均每个batch用时0.02165s, 预计epoch时间: 59.358s
run batch2000total time: 44.29s,presample: 2.15s, sample: 1.10s, prep time: 10.22s, gen block: 4.23s, feat input: 2.40s, model run: 7.50s,                    loss and opt: 21.82s, update mem: 1.27s update mailbox: 1.65s
feat_buffer time: IO load: 1.623s 异步阻塞: 0.001s presample and analyze: 0.519s 预采样: 0.000s, 预采样负采样:0.138s              记忆刷入和更新:0.282s 纯刷入时间:0.000s 负采样分析: 0.096s
total loop use time: 60.8654
run batch2741total time: 60.45s,presample: 2.65s, sample: 1.51s, prep time: 14.03s, gen block: 5.80s, feat input: 3.30s, model run: 10.25s,               loss and opt: 29.95s, update mem: 1.73s update mailbox: 2.27s
	train loss:2872065.8568  val ap:0.953613  val auc:0.947805, eval time: 26.26
Epoch 8:
IO load: 2.099s presample and analyze: 0.541s 预采样: 0.000s, 预采样负采样:0.159s
第一个块的加载时间: 0.644s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.296s 异步阻塞: 0.000s presample and analyze: 0.363s 预采样: 0.000s, 预采样负采样:0.028s              记忆刷入和更新:0.249s 纯刷入时间:0.000s 负采样分析: 0.085s
平均每个batch用时0.02237s, 预计epoch时间: 61.320s
run batch1000total time: 22.37s,presample: 1.29s, sample: 0.55s, prep time: 5.08s, gen block: 2.10s, feat input: 1.19s, model run: 3.73s,                    loss and opt: 10.97s, update mem: 0.62s update mailbox: 0.82s
feat_buffer time: IO load: 0.869s 异步阻塞: 0.000s presample and analyze: 0.416s 预采样: 0.000s, 预采样负采样:0.079s              记忆刷入和更新:0.249s 纯刷入时间:0.000s 负采样分析: 0.085s
平均每个batch用时0.02155s, 预计epoch时间: 59.081s
run batch2000total time: 43.92s,presample: 1.93s, sample: 1.09s, prep time: 10.14s, gen block: 4.20s, feat input: 2.39s, model run: 7.44s,                    loss and opt: 21.82s, update mem: 1.24s update mailbox: 1.64s
feat_buffer time: IO load: 1.450s 异步阻塞: 0.001s presample and analyze: 0.468s 预采样: 0.000s, 预采样负采样:0.130s              记忆刷入和更新:0.249s 纯刷入时间:0.000s 负采样分析: 0.085s
total loop use time: 60.2976
run batch2741total time: 59.91s,presample: 2.41s, sample: 1.49s, prep time: 13.90s, gen block: 5.74s, feat input: 3.28s, model run: 10.19s,               loss and opt: 29.88s, update mem: 1.70s update mailbox: 2.25s
	train loss:2859655.0211  val ap:0.952312  val auc:0.946065, eval time: 28.49
Epoch 9:
IO load: 1.909s presample and analyze: 0.490s 预采样: 0.000s, 预采样负采样:0.151s
第一个块的加载时间: 0.709s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.339s 异步阻塞: 0.000s presample and analyze: 0.388s 预采样: 0.000s, 预采样负采样:0.034s              记忆刷入和更新:0.260s 纯刷入时间:0.000s 负采样分析: 0.094s
平均每个batch用时0.02267s, 预计epoch时间: 62.144s
run batch1000total time: 22.67s,presample: 1.37s, sample: 0.55s, prep time: 5.14s, gen block: 2.13s, feat input: 1.21s, model run: 3.78s,                    loss and opt: 11.06s, update mem: 0.63s update mailbox: 0.83s
feat_buffer time: IO load: 0.921s 异步阻塞: 0.000s presample and analyze: 0.440s 预采样: 0.000s, 预采样负采样:0.085s              记忆刷入和更新:0.260s 纯刷入时间:0.000s 负采样分析: 0.094s
平均每个batch用时0.02215s, 预计epoch时间: 60.715s
run batch2000total time: 44.81s,presample: 2.04s, sample: 1.11s, prep time: 10.35s, gen block: 4.28s, feat input: 2.44s, model run: 7.61s,                    loss and opt: 22.18s, update mem: 1.27s update mailbox: 1.68s
feat_buffer time: IO load: 1.542s 异步阻塞: 0.001s presample and analyze: 0.494s 预采样: 0.000s, 预采样负采样:0.137s              记忆刷入和更新:0.260s 纯刷入时间:0.000s 负采样分析: 0.094s
total loop use time: 61.5885
run batch2741total time: 61.18s,presample: 2.56s, sample: 1.52s, prep time: 14.17s, gen block: 5.85s, feat input: 3.34s, model run: 10.42s,               loss and opt: 30.42s, update mem: 1.74s update mailbox: 2.30s
	train loss:2851159.5790  val ap:0.952348  val auc:0.946017, eval time: 27.45
Loading model at epoch 7...
	test AP:0.918132  test AUC:0.904704
训练完成，退出子进程
