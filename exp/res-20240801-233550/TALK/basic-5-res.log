训练配置: {'use_valid_edge': False, 'use_ayscn_prefetch': True, 'pre_sample_size': 600000, 'part_neg_sample': False}
Sent: init_feats
Received: None
Epoch 0:
IO load: 0.000s presample and analyze: 0.000s 预采样: 0.000s, 预采样负采样:0.000s
第一个块的加载时间: 1.662s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.296s 异步阻塞: 0.000s presample and analyze: 1.383s 预采样: 0.000s, 预采样负采样:0.035s              记忆刷入和更新:0.251s 纯刷入时间:0.000s 负采样分析: 1.097s
平均每个batch用时0.02448s, 预计epoch时间: 67.108s
run batch1000total time: 24.48s,presample: 2.32s, sample: 0.55s, prep time: 5.15s, gen block: 2.12s, feat input: 1.21s, model run: 4.84s,                    loss and opt: 10.87s, update mem: 0.63s update mailbox: 0.84s
feat_buffer time: IO load: 0.877s 异步阻塞: 0.000s presample and analyze: 1.440s 预采样: 0.000s, 预采样负采样:0.091s              记忆刷入和更新:0.251s 纯刷入时间:0.000s 负采样分析: 1.097s
平均每个batch用时0.02192s, 预计epoch时间: 60.098s
run batch2000total time: 46.40s,presample: 3.00s, sample: 1.10s, prep time: 10.34s, gen block: 4.26s, feat input: 2.44s, model run: 8.63s,                    loss and opt: 21.83s, update mem: 1.27s update mailbox: 1.68s
feat_buffer time: IO load: 1.494s 异步阻塞: 0.001s presample and analyze: 1.493s 预采样: 0.000s, 预采样负采样:0.143s              记忆刷入和更新:0.251s 纯刷入时间:0.000s 负采样分析: 1.097s
total loop use time: 62.1373
run batch2741total time: 61.74s,presample: 3.51s, sample: 1.49s, prep time: 13.96s, gen block: 5.75s, feat input: 3.30s, model run: 11.30s,               loss and opt: 29.45s, update mem: 1.72s update mailbox: 2.27s
	train loss:3563008.5900  val ap:0.942058  val auc:0.936748, eval time: 31.40
Epoch 1:
IO load: 1.978s presample and analyze: 1.516s 预采样: 0.000s, 预采样负采样:0.164s
第一个块的加载时间: 0.627s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.278s 异步阻塞: 0.000s presample and analyze: 0.364s 预采样: 0.000s, 预采样负采样:0.031s              记忆刷入和更新:0.245s 纯刷入时间:0.000s 负采样分析: 0.087s
平均每个batch用时0.02252s, 预计epoch时间: 61.730s
run batch1000total time: 22.52s,presample: 1.44s, sample: 0.54s, prep time: 5.04s, gen block: 2.08s, feat input: 1.15s, model run: 3.67s,                    loss and opt: 11.08s, update mem: 0.63s update mailbox: 0.84s
feat_buffer time: IO load: 1.014s 异步阻塞: 0.000s presample and analyze: 0.417s 预采样: 0.000s, 预采样负采样:0.083s              记忆刷入和更新:0.245s 纯刷入时间:0.000s 负采样分析: 0.087s
平均每个batch用时0.02196s, 预计epoch时间: 60.198s
run batch2000total time: 44.47s,presample: 2.28s, sample: 1.08s, prep time: 10.16s, gen block: 4.18s, feat input: 2.34s, model run: 7.36s,                    loss and opt: 22.09s, update mem: 1.28s update mailbox: 1.69s
feat_buffer time: IO load: 1.801s 异步阻塞: 0.001s presample and analyze: 0.471s 预采样: 0.000s, 预采样负采样:0.136s              记忆刷入和更新:0.245s 纯刷入时间:0.000s 负采样分析: 0.087s
total loop use time: 61.1616
run batch2741total time: 60.75s,presample: 2.91s, sample: 1.48s, prep time: 13.96s, gen block: 5.73s, feat input: 3.23s, model run: 10.10s,               loss and opt: 30.24s, update mem: 1.76s update mailbox: 2.32s
	train loss:3150355.0291  val ap:0.949208  val auc:0.943466, eval time: 29.40
Epoch 2:
IO load: 2.408s presample and analyze: 0.494s 预采样: 0.000s, 预采样负采样:0.157s
第一个块的加载时间: 0.600s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.257s 异步阻塞: 0.000s presample and analyze: 0.357s 预采样: 0.000s, 预采样负采样:0.027s              记忆刷入和更新:0.245s 纯刷入时间:0.000s 负采样分析: 0.085s
平均每个batch用时0.02219s, 预计epoch时间: 60.848s
run batch1000total time: 22.19s,presample: 1.40s, sample: 0.53s, prep time: 5.04s, gen block: 2.08s, feat input: 1.17s, model run: 3.64s,                    loss and opt: 10.84s, update mem: 0.63s update mailbox: 0.83s
feat_buffer time: IO load: 0.982s 异步阻塞: 0.000s presample and analyze: 0.410s 预采样: 0.000s, 预采样负采样:0.079s              记忆刷入和更新:0.245s 纯刷入时间:0.000s 负采样分析: 0.085s
平均每个batch用时0.02176s, 预计epoch时间: 59.668s
run batch2000total time: 43.96s,presample: 2.24s, sample: 1.07s, prep time: 10.10s, gen block: 4.16s, feat input: 2.35s, model run: 7.32s,                    loss and opt: 21.75s, update mem: 1.27s update mailbox: 1.66s
feat_buffer time: IO load: 1.763s 异步阻塞: 0.001s presample and analyze: 0.465s 预采样: 0.000s, 预采样负采样:0.132s              记忆刷入和更新:0.245s 纯刷入时间:0.000s 负采样分析: 0.085s
total loop use time: 60.6537
run batch2741total time: 60.25s,presample: 2.87s, sample: 1.47s, prep time: 13.89s, gen block: 5.71s, feat input: 3.22s, model run: 10.05s,               loss and opt: 29.92s, update mem: 1.75s update mailbox: 2.30s
	train loss:3020329.4341  val ap:0.950256  val auc:0.944996, eval time: 29.08
Epoch 3:
IO load: 2.369s presample and analyze: 0.488s 预采样: 0.000s, 预采样负采样:0.154s
第一个块的加载时间: 0.604s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.257s 异步阻塞: 0.000s presample and analyze: 0.361s 预采样: 0.000s, 预采样负采样:0.027s              记忆刷入和更新:0.247s 纯刷入时间:0.000s 负采样分析: 0.087s
平均每个batch用时0.02253s, 预计epoch时间: 61.757s
run batch1000total time: 22.53s,presample: 1.40s, sample: 0.56s, prep time: 5.13s, gen block: 2.12s, feat input: 1.18s, model run: 3.68s,                    loss and opt: 11.01s, update mem: 0.64s update mailbox: 0.85s
feat_buffer time: IO load: 0.978s 异步阻塞: 0.000s presample and analyze: 0.414s 预采样: 0.000s, 预采样负采样:0.078s              记忆刷入和更新:0.247s 纯刷入时间:0.000s 负采样分析: 0.087s
平均每个batch用时0.02189s, 预计epoch时间: 60.010s
run batch2000total time: 44.41s,presample: 2.23s, sample: 1.10s, prep time: 10.22s, gen block: 4.22s, feat input: 2.37s, model run: 7.39s,                    loss and opt: 21.97s, update mem: 1.28s update mailbox: 1.68s
feat_buffer time: IO load: 1.751s 异步阻塞: 0.001s presample and analyze: 0.468s 预采样: 0.000s, 预采样负采样:0.130s              记忆刷入和更新:0.247s 纯刷入时间:0.000s 负采样分析: 0.087s
total loop use time: 61.0716
run batch2741total time: 60.68s,presample: 2.86s, sample: 1.49s, prep time: 14.02s, gen block: 5.77s, feat input: 3.25s, model run: 10.13s,               loss and opt: 30.12s, update mem: 1.76s update mailbox: 2.31s
	train loss:2988421.6158  val ap:0.952345  val auc:0.946734, eval time: 29.75
Epoch 4:
IO load: 2.358s presample and analyze: 0.491s 预采样: 0.000s, 预采样负采样:0.152s
第一个块的加载时间: 0.671s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.302s 异步阻塞: 0.000s presample and analyze: 0.387s 预采样: 0.000s, 预采样负采样:0.035s              记忆刷入和更新:0.260s 纯刷入时间:0.000s 负采样分析: 0.092s
平均每个batch用时0.02275s, 预计epoch时间: 62.381s
run batch1000total time: 22.75s,presample: 1.50s, sample: 0.55s, prep time: 5.13s, gen block: 2.11s, feat input: 1.18s, model run: 3.74s,                    loss and opt: 11.08s, update mem: 0.64s update mailbox: 0.85s
feat_buffer time: IO load: 1.057s 异步阻塞: 0.000s presample and analyze: 0.441s 预采样: 0.000s, 预采样负采样:0.087s              记忆刷入和更新:0.260s 纯刷入时间:0.000s 负采样分析: 0.092s
平均每个batch用时0.02179s, 预计epoch时间: 59.744s
run batch2000total time: 44.54s,presample: 2.36s, sample: 1.08s, prep time: 10.18s, gen block: 4.19s, feat input: 2.36s, model run: 7.42s,                    loss and opt: 22.00s, update mem: 1.27s update mailbox: 1.68s
feat_buffer time: IO load: 1.851s 异步阻塞: 0.001s presample and analyze: 0.495s 预采样: 0.000s, 预采样负采样:0.140s              记忆刷入和更新:0.260s 纯刷入时间:0.000s 负采样分析: 0.092s
total loop use time: 61.2980
run batch2741total time: 60.89s,presample: 2.98s, sample: 1.49s, prep time: 13.97s, gen block: 5.75s, feat input: 3.24s, model run: 10.17s,               loss and opt: 30.22s, update mem: 1.75s update mailbox: 2.31s
	train loss:2923732.5112  val ap:0.954045  val auc:0.948483, eval time: 29.43
Epoch 5:
IO load: 2.457s presample and analyze: 0.515s 预采样: 0.000s, 预采样负采样:0.159s
第一个块的加载时间: 0.628s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.263s 异步阻塞: 0.000s presample and analyze: 0.379s 预采样: 0.000s, 预采样负采样:0.027s              记忆刷入和更新:0.263s 纯刷入时间:0.000s 负采样分析: 0.089s
平均每个batch用时0.02231s, 预计epoch时间: 61.155s
run batch1000total time: 22.31s,presample: 1.43s, sample: 0.53s, prep time: 5.04s, gen block: 2.06s, feat input: 1.19s, model run: 3.69s,                    loss and opt: 10.88s, update mem: 0.63s update mailbox: 0.83s
feat_buffer time: IO load: 0.993s 异步阻塞: 0.000s presample and analyze: 0.431s 预采样: 0.000s, 预采样负采样:0.078s              记忆刷入和更新:0.263s 纯刷入时间:0.000s 负采样分析: 0.089s
平均每个batch用时0.02236s, 预计epoch时间: 61.299s
run batch2000total time: 44.66s,presample: 2.27s, sample: 1.08s, prep time: 10.22s, gen block: 4.18s, feat input: 2.38s, model run: 7.62s,                    loss and opt: 21.98s, update mem: 1.28s update mailbox: 1.70s
feat_buffer time: IO load: 1.771s 异步阻塞: 0.001s presample and analyze: 0.486s 预采样: 0.000s, 预采样负采样:0.131s              记忆刷入和更新:0.263s 纯刷入时间:0.000s 负采样分析: 0.089s
total loop use time: 61.1963
run batch2741total time: 60.82s,presample: 2.90s, sample: 1.48s, prep time: 14.01s, gen block: 5.74s, feat input: 3.26s, model run: 10.36s,               loss and opt: 30.02s, update mem: 1.76s update mailbox: 2.32s
	train loss:2905543.7459  val ap:0.954595  val auc:0.949160, eval time: 30.08
Epoch 6:
IO load: 2.382s presample and analyze: 0.509s 预采样: 0.000s, 预采样负采样:0.153s
第一个块的加载时间: 0.684s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.304s 异步阻塞: 0.000s presample and analyze: 0.398s 预采样: 0.000s, 预采样负采样:0.034s              记忆刷入和更新:0.271s 纯刷入时间:0.000s 负采样分析: 0.093s
平均每个batch用时0.02276s, 预计epoch时间: 62.405s
run batch1000total time: 22.76s,presample: 1.50s, sample: 0.55s, prep time: 5.16s, gen block: 2.12s, feat input: 1.18s, model run: 3.71s,                    loss and opt: 11.08s, update mem: 0.65s update mailbox: 0.86s
feat_buffer time: IO load: 1.046s 异步阻塞: 0.000s presample and analyze: 0.453s 预采样: 0.000s, 预采样负采样:0.086s              记忆刷入和更新:0.271s 纯刷入时间:0.000s 负采样分析: 0.093s
平均每个batch用时0.02128s, 预计epoch时间: 58.340s
run batch2000total time: 44.04s,presample: 2.35s, sample: 1.07s, prep time: 10.12s, gen block: 4.16s, feat input: 2.33s, model run: 7.29s,                    loss and opt: 21.73s, update mem: 1.28s update mailbox: 1.69s
feat_buffer time: IO load: 1.836s 异步阻塞: 0.001s presample and analyze: 0.506s 预采样: 0.000s, 预采样负采样:0.138s              记忆刷入和更新:0.271s 纯刷入时间:0.000s 负采样分析: 0.093s
total loop use time: 60.7354
run batch2741total time: 60.31s,presample: 2.99s, sample: 1.47s, prep time: 13.90s, gen block: 5.70s, feat input: 3.19s, model run: 10.02s,               loss and opt: 29.90s, update mem: 1.76s update mailbox: 2.32s
	train loss:2895350.7689  val ap:0.954232  val auc:0.948599, eval time: 32.16
Epoch 7:
IO load: 2.451s presample and analyze: 0.525s 预采样: 0.000s, 预采样负采样:0.157s
第一个块的加载时间: 0.672s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.300s 异步阻塞: 0.000s presample and analyze: 0.390s 预采样: 0.000s, 预采样负采样:0.033s              记忆刷入和更新:0.266s 纯刷入时间:0.000s 负采样分析: 0.090s
平均每个batch用时0.02235s, 预计epoch时间: 61.286s
run batch1000total time: 22.35s,presample: 1.47s, sample: 0.54s, prep time: 5.04s, gen block: 2.08s, feat input: 1.15s, model run: 3.61s,                    loss and opt: 10.95s, update mem: 0.64s update mailbox: 0.84s
feat_buffer time: IO load: 1.022s 异步阻塞: 0.000s presample and analyze: 0.443s 预采样: 0.000s, 预采样负采样:0.085s              记忆刷入和更新:0.266s 纯刷入时间:0.000s 负采样分析: 0.090s
平均每个batch用时0.02227s, 预计epoch时间: 61.065s
run batch2000total time: 44.63s,presample: 2.30s, sample: 1.09s, prep time: 10.23s, gen block: 4.22s, feat input: 2.36s, model run: 7.36s,                    loss and opt: 22.14s, update mem: 1.29s update mailbox: 1.69s
feat_buffer time: IO load: 1.795s 异步阻塞: 0.001s presample and analyze: 0.497s 预采样: 0.000s, 预采样负采样:0.138s              记忆刷入和更新:0.266s 纯刷入时间:0.000s 负采样分析: 0.090s
total loop use time: 60.8666
run batch2741total time: 60.44s,presample: 2.93s, sample: 1.47s, prep time: 13.91s, gen block: 5.73s, feat input: 3.21s, model run: 10.02s,               loss and opt: 30.07s, update mem: 1.75s update mailbox: 2.30s
	train loss:2858350.4360  val ap:0.955059  val auc:0.949488, eval time: 30.05
Epoch 8:
IO load: 2.399s presample and analyze: 0.520s 预采样: 0.000s, 预采样负采样:0.160s
第一个块的加载时间: 0.676s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.300s 异步阻塞: 0.000s presample and analyze: 0.393s 预采样: 0.000s, 预采样负采样:0.033s              记忆刷入和更新:0.269s 纯刷入时间:0.000s 负采样分析: 0.091s
平均每个batch用时0.02323s, 预计epoch时间: 63.678s
run batch1000total time: 23.23s,presample: 1.48s, sample: 0.56s, prep time: 5.21s, gen block: 2.13s, feat input: 1.20s, model run: 3.78s,                    loss and opt: 11.43s, update mem: 0.66s update mailbox: 0.88s
feat_buffer time: IO load: 1.033s 异步阻塞: 0.000s presample and analyze: 0.446s 预采样: 0.000s, 预采样负采样:0.085s              记忆刷入和更新:0.269s 纯刷入时间:0.000s 负采样分析: 0.091s
平均每个batch用时0.02227s, 预计epoch时间: 61.052s
run batch2000total time: 45.49s,presample: 2.32s, sample: 1.10s, prep time: 10.39s, gen block: 4.26s, feat input: 2.40s, model run: 7.53s,                    loss and opt: 22.63s, update mem: 1.31s update mailbox: 1.73s
feat_buffer time: IO load: 1.815s 异步阻塞: 0.001s presample and analyze: 0.500s 预采样: 0.000s, 预采样负采样:0.137s              记忆刷入和更新:0.269s 纯刷入时间:0.000s 负采样分析: 0.091s
total loop use time: 62.4302
run batch2741total time: 62.00s,presample: 2.97s, sample: 1.51s, prep time: 14.23s, gen block: 5.83s, feat input: 3.29s, model run: 10.29s,               loss and opt: 30.92s, update mem: 1.80s update mailbox: 2.37s
	train loss:2833588.4418  val ap:0.955166  val auc:0.949595, eval time: 28.97
Epoch 9:
IO load: 2.431s presample and analyze: 0.524s 预采样: 0.000s, 预采样负采样:0.160s
第一个块的加载时间: 0.632s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.263s 异步阻塞: 0.000s presample and analyze: 0.383s 预采样: 0.000s, 预采样负采样:0.027s              记忆刷入和更新:0.266s 纯刷入时间:0.000s 负采样分析: 0.090s
平均每个batch用时0.02285s, 预计epoch时间: 62.657s
run batch1000total time: 22.85s,presample: 1.43s, sample: 0.55s, prep time: 5.15s, gen block: 2.12s, feat input: 1.18s, model run: 3.72s,                    loss and opt: 11.25s, update mem: 0.65s update mailbox: 0.86s
feat_buffer time: IO load: 0.990s 异步阻塞: 0.000s presample and analyze: 0.437s 预采样: 0.000s, 预采样负采样:0.079s              记忆刷入和更新:0.266s 纯刷入时间:0.000s 负采样分析: 0.090s
平均每个batch用时0.02225s, 预计epoch时间: 61.000s
run batch2000total time: 45.10s,presample: 2.26s, sample: 1.09s, prep time: 10.33s, gen block: 4.25s, feat input: 2.38s, model run: 7.41s,                    loss and opt: 22.49s, update mem: 1.31s update mailbox: 1.71s
feat_buffer time: IO load: 1.765s 异步阻塞: 0.001s presample and analyze: 0.490s 预采样: 0.000s, 预采样负采样:0.131s              记忆刷入和更新:0.266s 纯刷入时间:0.000s 负采样分析: 0.090s
total loop use time: 61.9474
run batch2741total time: 61.54s,presample: 2.90s, sample: 1.50s, prep time: 14.15s, gen block: 5.81s, feat input: 3.27s, model run: 10.18s,               loss and opt: 30.75s, update mem: 1.79s update mailbox: 2.34s
	train loss:2826666.8428  val ap:0.955614  val auc:0.950052, eval time: 28.48
Loading model at epoch 9...
	test AP:0.931439  test AUC:0.921500
训练完成，退出子进程
