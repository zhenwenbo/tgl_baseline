训练配置: {'use_valid_edge': False, 'use_ayscn_prefetch': True, 'pre_sample_size': 600000, 'part_neg_sample': False}
Sent: init_feats
Received: None
Epoch 0:
IO load: 0.000s presample and analyze: 0.000s 预采样: 0.000s, 预采样负采样:0.000s
第一个块的加载时间: 1.931s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.321s 异步阻塞: 0.000s presample and analyze: 1.628s 预采样: 0.000s, 预采样负采样:0.041s              记忆刷入和更新:0.239s 纯刷入时间:0.000s 负采样分析: 1.347s
平均每个batch用时0.02419s, 预计epoch时间: 66.324s
run batch1000total time: 24.19s,presample: 2.55s, sample: 0.53s, prep time: 4.94s, gen block: 2.06s, feat input: 1.15s, model run: 4.95s,                    loss and opt: 10.49s, update mem: 0.60s update mailbox: 0.80s
feat_buffer time: IO load: 0.866s 异步阻塞: 0.000s presample and analyze: 1.683s 预采样: 0.000s, 预采样负采样:0.094s              记忆刷入和更新:0.239s 纯刷入时间:0.000s 负采样分析: 1.347s
平均每个batch用时0.02141s, 预计epoch时间: 58.706s
run batch2000total time: 45.60s,presample: 3.23s, sample: 1.07s, prep time: 10.00s, gen block: 4.14s, feat input: 2.33s, model run: 8.68s,                    loss and opt: 21.14s, update mem: 1.23s update mailbox: 1.64s
feat_buffer time: IO load: 1.487s 异步阻塞: 0.001s presample and analyze: 1.737s 预采样: 0.000s, 预采样负采样:0.147s              记忆刷入和更新:0.239s 纯刷入时间:0.000s 负采样分析: 1.347s
total loop use time: 61.5670
run batch2741total time: 61.14s,presample: 3.74s, sample: 1.46s, prep time: 13.65s, gen block: 5.65s, feat input: 3.19s, model run: 11.36s,               loss and opt: 28.91s, update mem: 1.67s update mailbox: 2.23s
	train loss:3576530.4226  val ap:0.943620  val auc:0.937021, eval time: 29.56
Epoch 1:
IO load: 1.967s presample and analyze: 1.760s 预采样: 0.000s, 预采样负采样:0.169s
第一个块的加载时间: 0.626s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.295s 异步阻塞: 0.000s presample and analyze: 0.345s 预采样: 0.000s, 预采样负采样:0.029s              记忆刷入和更新:0.237s 纯刷入时间:0.000s 负采样分析: 0.079s
平均每个batch用时0.02237s, 预计epoch时间: 61.324s
run batch1000total time: 22.37s,presample: 1.25s, sample: 0.55s, prep time: 5.14s, gen block: 2.13s, feat input: 1.21s, model run: 3.77s,                    loss and opt: 10.90s, update mem: 0.62s update mailbox: 0.83s
feat_buffer time: IO load: 0.849s 异步阻塞: 0.000s presample and analyze: 0.394s 预采样: 0.000s, 预采样负采样:0.077s              记忆刷入和更新:0.237s 纯刷入时间:0.000s 负采样分析: 0.079s
平均每个batch用时0.02180s, 预计epoch时间: 59.760s
run batch2000total time: 44.16s,presample: 1.90s, sample: 1.10s, prep time: 10.30s, gen block: 4.27s, feat input: 2.43s, model run: 7.57s,                    loss and opt: 21.79s, update mem: 1.25s update mailbox: 1.67s
feat_buffer time: IO load: 1.439s 异步阻塞: 0.001s presample and analyze: 0.447s 预采样: 0.000s, 预采样负采样:0.128s              记忆刷入和更新:0.237s 纯刷入时间:0.000s 负采样分析: 0.079s
total loop use time: 60.6329
run batch2741total time: 60.23s,presample: 2.38s, sample: 1.51s, prep time: 14.09s, gen block: 5.84s, feat input: 3.33s, model run: 10.35s,               loss and opt: 29.82s, update mem: 1.71s update mailbox: 2.28s
	train loss:3121901.0237  val ap:0.949031  val auc:0.943126, eval time: 29.05
Epoch 2:
IO load: 1.903s presample and analyze: 0.469s 预采样: 0.000s, 预采样负采样:0.149s
第一个块的加载时间: 0.623s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.296s 异步阻塞: 0.000s presample and analyze: 0.341s 预采样: 0.000s, 预采样负采样:0.027s              记忆刷入和更新:0.232s 纯刷入时间:0.000s 负采样分析: 0.081s
平均每个batch用时0.02218s, 预计epoch时间: 60.801s
run batch1000total time: 22.18s,presample: 1.26s, sample: 0.53s, prep time: 5.02s, gen block: 2.07s, feat input: 1.16s, model run: 3.68s,                    loss and opt: 10.96s, update mem: 0.62s update mailbox: 0.83s
feat_buffer time: IO load: 0.862s 异步阻塞: 0.000s presample and analyze: 0.392s 预采样: 0.000s, 预采样负采样:0.077s              记忆刷入和更新:0.232s 纯刷入时间:0.000s 负采样分析: 0.081s
平均每个batch用时0.02199s, 预计epoch时间: 60.274s
run batch2000total time: 44.16s,presample: 1.94s, sample: 1.09s, prep time: 10.17s, gen block: 4.20s, feat input: 2.37s, model run: 7.49s,                    loss and opt: 21.99s, update mem: 1.25s update mailbox: 1.67s
feat_buffer time: IO load: 1.488s 异步阻塞: 0.001s presample and analyze: 0.445s 预采样: 0.000s, 预采样负采样:0.128s              记忆刷入和更新:0.232s 纯刷入时间:0.000s 负采样分析: 0.081s
total loop use time: 60.5966
run batch2741total time: 60.22s,presample: 2.43s, sample: 1.49s, prep time: 13.95s, gen block: 5.77s, feat input: 3.27s, model run: 10.26s,               loss and opt: 30.05s, update mem: 1.71s update mailbox: 2.28s
	train loss:3023640.8084  val ap:0.950359  val auc:0.944693, eval time: 28.52
Epoch 3:
IO load: 1.951s presample and analyze: 0.466s 预采样: 0.000s, 预采样负采样:0.149s
第一个块的加载时间: 0.620s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.294s 异步阻塞: 0.000s presample and analyze: 0.341s 预采样: 0.000s, 预采样负采样:0.028s              记忆刷入和更新:0.235s 纯刷入时间:0.000s 负采样分析: 0.078s
平均每个batch用时0.02214s, 预计epoch时间: 60.694s
run batch1000total time: 22.14s,presample: 1.23s, sample: 0.54s, prep time: 5.07s, gen block: 2.10s, feat input: 1.19s, model run: 3.74s,                    loss and opt: 10.81s, update mem: 0.62s update mailbox: 0.82s
feat_buffer time: IO load: 0.836s 异步阻塞: 0.000s presample and analyze: 0.392s 预采样: 0.000s, 预采样负采样:0.078s              记忆刷入和更新:0.235s 纯刷入时间:0.000s 负采样分析: 0.078s
平均每个batch用时0.02160s, 预计epoch时间: 59.218s
run batch2000total time: 43.74s,presample: 1.87s, sample: 1.09s, prep time: 10.18s, gen block: 4.22s, feat input: 2.40s, model run: 7.49s,                    loss and opt: 21.62s, update mem: 1.24s update mailbox: 1.65s
feat_buffer time: IO load: 1.414s 异步阻塞: 0.001s presample and analyze: 0.444s 预采样: 0.000s, 预采样负采样:0.129s              记忆刷入和更新:0.235s 纯刷入时间:0.000s 负采样分析: 0.078s
total loop use time: 60.2698
run batch2741total time: 59.88s,presample: 2.37s, sample: 1.49s, prep time: 13.98s, gen block: 5.79s, feat input: 3.30s, model run: 10.28s,               loss and opt: 29.71s, update mem: 1.71s update mailbox: 2.26s
	train loss:2951817.1565  val ap:0.952422  val auc:0.946791, eval time: 28.12
Epoch 4:
IO load: 1.890s presample and analyze: 0.466s 预采样: 0.000s, 预采样负采样:0.150s
第一个块的加载时间: 0.620s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.295s 异步阻塞: 0.000s presample and analyze: 0.340s 预采样: 0.000s, 预采样负采样:0.027s              记忆刷入和更新:0.233s 纯刷入时间:0.000s 负采样分析: 0.080s
平均每个batch用时0.02241s, 预计epoch时间: 61.439s
run batch1000total time: 22.41s,presample: 1.25s, sample: 0.55s, prep time: 5.12s, gen block: 2.12s, feat input: 1.20s, model run: 3.77s,                    loss and opt: 10.96s, update mem: 0.62s update mailbox: 0.83s
feat_buffer time: IO load: 0.857s 异步阻塞: 0.000s presample and analyze: 0.391s 预采样: 0.000s, 预采样负采样:0.077s              记忆刷入和更新:0.233s 纯刷入时间:0.000s 负采样分析: 0.080s
平均每个batch用时0.02195s, 预计epoch时间: 60.179s
run batch2000total time: 44.36s,presample: 1.93s, sample: 1.11s, prep time: 10.31s, gen block: 4.27s, feat input: 2.43s, model run: 7.59s,                    loss and opt: 21.91s, update mem: 1.25s update mailbox: 1.67s
feat_buffer time: IO load: 1.474s 异步阻塞: 0.001s presample and analyze: 0.445s 预采样: 0.000s, 预采样负采样:0.130s              记忆刷入和更新:0.233s 纯刷入时间:0.000s 负采样分析: 0.080s
total loop use time: 60.8002
run batch2741total time: 60.41s,presample: 2.43s, sample: 1.51s, prep time: 14.09s, gen block: 5.84s, feat input: 3.32s, model run: 10.37s,               loss and opt: 29.95s, update mem: 1.71s update mailbox: 2.28s
	train loss:2947449.9706  val ap:0.951477  val auc:0.945514, eval time: 28.20
Epoch 5:
IO load: 1.946s presample and analyze: 0.468s 预采样: 0.000s, 预采样负采样:0.151s
第一个块的加载时间: 0.854s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.469s 异步阻塞: 0.000s presample and analyze: 0.403s 预采样: 0.000s, 预采样负采样:0.038s              记忆刷入和更新:0.275s 纯刷入时间:0.000s 负采样分析: 0.090s
平均每个batch用时0.02267s, 预计epoch时间: 62.156s
run batch1000total time: 22.67s,presample: 1.48s, sample: 0.55s, prep time: 5.14s, gen block: 2.13s, feat input: 1.21s, model run: 3.79s,                    loss and opt: 10.95s, update mem: 0.63s update mailbox: 0.83s
feat_buffer time: IO load: 1.019s 异步阻塞: 0.000s presample and analyze: 0.455s 预采样: 0.000s, 预采样负采样:0.088s              记忆刷入和更新:0.275s 纯刷入时间:0.000s 负采样分析: 0.090s
平均每个batch用时0.02169s, 预计epoch时间: 59.472s
run batch2000total time: 44.36s,presample: 2.12s, sample: 1.10s, prep time: 10.27s, gen block: 4.25s, feat input: 2.42s, model run: 7.55s,                    loss and opt: 21.81s, update mem: 1.25s update mailbox: 1.66s
feat_buffer time: IO load: 1.605s 异步阻塞: 0.001s presample and analyze: 0.508s 预采样: 0.000s, 预采样负采样:0.140s              记忆刷入和更新:0.275s 纯刷入时间:0.000s 负采样分析: 0.090s
total loop use time: 60.9439
run batch2741total time: 60.51s,presample: 2.63s, sample: 1.50s, prep time: 14.06s, gen block: 5.82s, feat input: 3.32s, model run: 10.40s,               loss and opt: 29.86s, update mem: 1.71s update mailbox: 2.28s
	train loss:2904323.3784  val ap:0.952821  val auc:0.946781, eval time: 27.25
Epoch 6:
IO load: 2.085s presample and analyze: 0.530s 预采样: 0.000s, 预采样负采样:0.161s
第一个块的加载时间: 0.663s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.328s 异步阻塞: 0.000s presample and analyze: 0.351s 预采样: 0.000s, 预采样负采样:0.032s              记忆刷入和更新:0.238s 纯刷入时间:0.000s 负采样分析: 0.081s
平均每个batch用时0.02219s, 预计epoch时间: 60.829s
run batch1000total time: 22.19s,presample: 1.29s, sample: 0.54s, prep time: 5.08s, gen block: 2.11s, feat input: 1.20s, model run: 3.73s,                    loss and opt: 10.79s, update mem: 0.62s update mailbox: 0.82s
feat_buffer time: IO load: 0.881s 异步阻塞: 0.000s presample and analyze: 0.402s 预采样: 0.000s, 预采样负采样:0.081s              记忆刷入和更新:0.238s 纯刷入时间:0.000s 负采样分析: 0.081s
平均每个batch用时0.02152s, 预计epoch时间: 58.998s
run batch2000total time: 43.71s,presample: 1.93s, sample: 1.08s, prep time: 10.14s, gen block: 4.20s, feat input: 2.39s, model run: 7.45s,                    loss and opt: 21.60s, update mem: 1.23s update mailbox: 1.64s
feat_buffer time: IO load: 1.470s 异步阻塞: 0.001s presample and analyze: 0.455s 预采样: 0.000s, 预采样负采样:0.132s              记忆刷入和更新:0.238s 纯刷入时间:0.000s 负采样分析: 0.081s
total loop use time: 60.0209
run batch2741total time: 59.62s,presample: 2.41s, sample: 1.48s, prep time: 13.90s, gen block: 5.76s, feat input: 3.28s, model run: 10.20s,               loss and opt: 29.57s, update mem: 1.69s update mailbox: 2.24s
	train loss:2912674.1199  val ap:0.953650  val auc:0.947926, eval time: 29.01
Epoch 7:
IO load: 1.929s presample and analyze: 0.473s 预采样: 0.000s, 预采样负采样:0.150s
第一个块的加载时间: 0.851s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.456s 异步阻塞: 0.000s presample and analyze: 0.413s 预采样: 0.000s, 预采样负采样:0.037s              记忆刷入和更新:0.286s 纯刷入时间:0.000s 负采样分析: 0.089s
平均每个batch用时0.02286s, 预计epoch时间: 62.672s
run batch1000total time: 22.86s,presample: 1.50s, sample: 0.57s, prep time: 5.21s, gen block: 2.16s, feat input: 1.22s, model run: 3.85s,                    loss and opt: 10.97s, update mem: 0.64s update mailbox: 0.84s
feat_buffer time: IO load: 1.034s 异步阻塞: 0.000s presample and analyze: 0.465s 预采样: 0.000s, 预采样负采样:0.088s              记忆刷入和更新:0.286s 纯刷入时间:0.000s 负采样分析: 0.089s
平均每个batch用时0.02195s, 预计epoch时间: 60.191s
run batch2000total time: 44.81s,presample: 2.18s, sample: 1.12s, prep time: 10.42s, gen block: 4.32s, feat input: 2.45s, model run: 7.68s,                    loss and opt: 21.89s, update mem: 1.27s update mailbox: 1.69s
feat_buffer time: IO load: 1.656s 异步阻塞: 0.001s presample and analyze: 0.518s 预采样: 0.000s, 预采样负采样:0.139s              记忆刷入和更新:0.286s 纯刷入时间:0.000s 负采样分析: 0.089s
total loop use time: 61.4263
run batch2741total time: 60.98s,presample: 2.70s, sample: 1.53s, prep time: 14.23s, gen block: 5.90s, feat input: 3.35s, model run: 10.49s,               loss and opt: 29.95s, update mem: 1.73s update mailbox: 2.30s
	train loss:2916465.8560  val ap:0.952819  val auc:0.946896, eval time: 28.52
Epoch 8:
IO load: 2.147s presample and analyze: 0.541s 预采样: 0.000s, 预采样负采样:0.162s
第一个块的加载时间: 0.624s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.304s 异步阻塞: 0.000s presample and analyze: 0.334s 预采样: 0.000s, 预采样负采样:0.027s              记忆刷入和更新:0.229s 纯刷入时间:0.000s 负采样分析: 0.078s
平均每个batch用时0.02194s, 预计epoch时间: 60.147s
run batch1000total time: 21.94s,presample: 1.24s, sample: 0.54s, prep time: 5.03s, gen block: 2.08s, feat input: 1.17s, model run: 3.66s,                    loss and opt: 10.73s, update mem: 0.62s update mailbox: 0.82s
feat_buffer time: IO load: 0.853s 异步阻塞: 0.000s presample and analyze: 0.386s 预采样: 0.000s, 预采样负采样:0.077s              记忆刷入和更新:0.229s 纯刷入时间:0.000s 负采样分析: 0.078s
平均每个batch用时0.02152s, 预计epoch时间: 59.000s
run batch2000total time: 43.46s,presample: 1.88s, sample: 1.09s, prep time: 10.11s, gen block: 4.20s, feat input: 2.36s, model run: 7.32s,                    loss and opt: 21.58s, update mem: 1.24s update mailbox: 1.64s
feat_buffer time: IO load: 1.435s 异步阻塞: 0.001s presample and analyze: 0.438s 预采样: 0.000s, 预采样负采样:0.128s              记忆刷入和更新:0.229s 纯刷入时间:0.000s 负采样分析: 0.078s
total loop use time: 59.7956
run batch2741total time: 59.39s,presample: 2.36s, sample: 1.49s, prep time: 13.88s, gen block: 5.75s, feat input: 3.25s, model run: 10.07s,               loss and opt: 29.57s, update mem: 1.70s update mailbox: 2.25s
	train loss:2873251.5217  val ap:0.955157  val auc:0.949604, eval time: 25.52
Epoch 9:
IO load: 1.890s presample and analyze: 0.460s 预采样: 0.000s, 预采样负采样:0.149s
第一个块的加载时间: 0.621s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.291s 异步阻塞: 0.000s presample and analyze: 0.344s 预采样: 0.000s, 预采样负采样:0.027s              记忆刷入和更新:0.237s 纯刷入时间:0.000s 负采样分析: 0.080s
平均每个batch用时0.02223s, 预计epoch时间: 60.942s
run batch1000total time: 22.23s,presample: 1.24s, sample: 0.54s, prep time: 5.08s, gen block: 2.11s, feat input: 1.20s, model run: 3.73s,                    loss and opt: 10.89s, update mem: 0.62s update mailbox: 0.82s
feat_buffer time: IO load: 0.839s 异步阻塞: 0.000s presample and analyze: 0.393s 预采样: 0.000s, 预采样负采样:0.073s              记忆刷入和更新:0.237s 纯刷入时间:0.000s 负采样分析: 0.080s
平均每个batch用时0.02195s, 预计epoch时间: 60.175s
run batch2000total time: 44.18s,presample: 1.89s, sample: 1.10s, prep time: 10.26s, gen block: 4.24s, feat input: 2.42s, model run: 7.52s,                    loss and opt: 21.90s, update mem: 1.25s update mailbox: 1.66s
feat_buffer time: IO load: 1.436s 异步阻塞: 0.001s presample and analyze: 0.445s 预采样: 0.000s, 预采样负采样:0.125s              记忆刷入和更新:0.237s 纯刷入时间:0.000s 负采样分析: 0.080s
total loop use time: 60.5843
run batch2741total time: 60.20s,presample: 2.37s, sample: 1.50s, prep time: 14.04s, gen block: 5.81s, feat input: 3.30s, model run: 10.24s,               loss and opt: 29.98s, update mem: 1.72s update mailbox: 2.28s
	train loss:2847377.9101  val ap:0.955093  val auc:0.949316, eval time: 25.97
Loading model at epoch 8...
	test AP:0.892147  test AUC:0.883079
训练完成，退出子进程
