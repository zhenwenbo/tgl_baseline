训练配置: {'use_valid_edge': False, 'use_ayscn_prefetch': True, 'pre_sample_size': 600000, 'part_neg_sample': False}
Sent: init_feats
Received: None
Epoch 0:
IO load: 0.000s presample and analyze: 0.000s 预采样: 0.000s, 预采样负采样:0.000s
第一个块的加载时间: 2.007s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.321s 异步阻塞: 0.000s presample and analyze: 1.705s 预采样: 0.000s, 预采样负采样:0.042s              记忆刷入和更新:0.235s 纯刷入时间:0.000s 负采样分析: 1.427s
平均每个batch用时0.02410s, 预计epoch时间: 66.079s
run batch1000total time: 24.10s,presample: 2.65s, sample: 0.52s, prep time: 4.95s, gen block: 2.06s, feat input: 1.15s, model run: 4.66s,                    loss and opt: 10.58s, update mem: 0.61s update mailbox: 0.81s
feat_buffer time: IO load: 0.880s 异步阻塞: 0.000s presample and analyze: 1.761s 预采样: 0.000s, 预采样负采样:0.097s              记忆刷入和更新:0.235s 纯刷入时间:0.000s 负采样分析: 1.427s
平均每个batch用时0.02114s, 预计epoch时间: 57.967s
run batch2000total time: 45.25s,presample: 3.29s, sample: 1.05s, prep time: 9.94s, gen block: 4.13s, feat input: 2.32s, model run: 8.29s,                    loss and opt: 21.21s, update mem: 1.22s update mailbox: 1.62s
feat_buffer time: IO load: 1.464s 异步阻塞: 0.001s presample and analyze: 1.813s 预采样: 0.000s, 预采样负采样:0.148s              记忆刷入和更新:0.235s 纯刷入时间:0.000s 负采样分析: 1.427s
total loop use time: 61.4770
run batch2741total time: 61.04s,presample: 3.77s, sample: 1.45s, prep time: 13.66s, gen block: 5.66s, feat input: 3.18s, model run: 10.99s,               loss and opt: 29.16s, update mem: 1.68s update mailbox: 2.22s
	train loss:3573510.7588  val ap:0.940987  val auc:0.934142, eval time: 31.28
Epoch 1:
IO load: 1.924s presample and analyze: 1.835s 预采样: 0.000s, 预采样负采样:0.168s
第一个块的加载时间: 0.635s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.298s 异步阻塞: 0.000s presample and analyze: 0.353s 预采样: 0.000s, 预采样负采样:0.028s              记忆刷入和更新:0.241s 纯刷入时间:0.000s 负采样分析: 0.083s
平均每个batch用时0.02213s, 预计epoch时间: 60.682s
run batch1000total time: 22.13s,presample: 1.25s, sample: 0.54s, prep time: 5.01s, gen block: 2.07s, feat input: 1.18s, model run: 3.66s,                    loss and opt: 10.93s, update mem: 0.62s update mailbox: 0.82s
feat_buffer time: IO load: 0.846s 异步阻塞: 0.000s presample and analyze: 0.404s 预采样: 0.000s, 预采样负采样:0.078s              记忆刷入和更新:0.241s 纯刷入时间:0.000s 负采样分析: 0.083s
平均每个batch用时0.02168s, 预计epoch时间: 59.430s
run batch2000total time: 43.81s,presample: 1.89s, sample: 1.08s, prep time: 10.09s, gen block: 4.16s, feat input: 2.36s, model run: 7.35s,                    loss and opt: 21.92s, update mem: 1.25s update mailbox: 1.65s
feat_buffer time: IO load: 1.426s 异步阻塞: 0.001s presample and analyze: 0.456s 预采样: 0.000s, 预采样负采样:0.129s              记忆刷入和更新:0.241s 纯刷入时间:0.000s 负采样分析: 0.083s
total loop use time: 60.3782
run batch2741total time: 59.98s,presample: 2.38s, sample: 1.49s, prep time: 13.90s, gen block: 5.73s, feat input: 3.26s, model run: 10.12s,               loss and opt: 30.06s, update mem: 1.72s update mailbox: 2.27s
	train loss:3103425.1159  val ap:0.950604  val auc:0.944849, eval time: 28.43
Epoch 2:
IO load: 1.889s presample and analyze: 0.477s 预采样: 0.000s, 预采样负采样:0.150s
第一个块的加载时间: 0.618s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.292s 异步阻塞: 0.000s presample and analyze: 0.341s 预采样: 0.000s, 预采样负采样:0.027s              记忆刷入和更新:0.234s 纯刷入时间:0.000s 负采样分析: 0.080s
平均每个batch用时0.02229s, 预计epoch时间: 61.107s
run batch1000total time: 22.29s,presample: 1.26s, sample: 0.55s, prep time: 5.07s, gen block: 2.09s, feat input: 1.18s, model run: 3.69s,                    loss and opt: 10.97s, update mem: 0.63s update mailbox: 0.83s
feat_buffer time: IO load: 0.866s 异步阻塞: 0.000s presample and analyze: 0.395s 预采样: 0.000s, 预采样负采样:0.079s              记忆刷入和更新:0.234s 纯刷入时间:0.000s 负采样分析: 0.080s
平均每个batch用时0.02172s, 预计epoch时间: 59.545s
run batch2000total time: 44.01s,presample: 1.95s, sample: 1.10s, prep time: 10.16s, gen block: 4.19s, feat input: 2.37s, model run: 7.39s,                    loss and opt: 21.91s, update mem: 1.26s update mailbox: 1.67s
feat_buffer time: IO load: 1.495s 异步阻塞: 0.001s presample and analyze: 0.447s 预采样: 0.000s, 预采样负采样:0.131s              记忆刷入和更新:0.234s 纯刷入时间:0.000s 负采样分析: 0.080s
total loop use time: 60.5290
run batch2741total time: 60.12s,presample: 2.46s, sample: 1.50s, prep time: 13.93s, gen block: 5.75s, feat input: 3.25s, model run: 10.14s,               loss and opt: 30.04s, update mem: 1.72s update mailbox: 2.28s
	train loss:3052857.9452  val ap:0.952187  val auc:0.946266, eval time: 29.56
Epoch 3:
IO load: 1.980s presample and analyze: 0.470s 预采样: 0.000s, 预采样负采样:0.152s
第一个块的加载时间: 0.661s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.334s 异步阻塞: 0.000s presample and analyze: 0.344s 预采样: 0.000s, 预采样负采样:0.033s              记忆刷入和更新:0.233s 纯刷入时间:0.000s 负采样分析: 0.078s
平均每个batch用时0.02188s, 预计epoch时间: 59.976s
run batch1000total time: 21.88s,presample: 1.29s, sample: 0.54s, prep time: 4.99s, gen block: 2.07s, feat input: 1.16s, model run: 3.61s,                    loss and opt: 10.71s, update mem: 0.62s update mailbox: 0.81s
feat_buffer time: IO load: 0.893s 异步阻塞: 0.000s presample and analyze: 0.395s 预采样: 0.000s, 预采样负采样:0.083s              记忆刷入和更新:0.233s 纯刷入时间:0.000s 负采样分析: 0.078s
平均每个batch用时0.02142s, 预计epoch时间: 58.730s
run batch2000total time: 43.30s,presample: 1.93s, sample: 1.08s, prep time: 10.02s, gen block: 4.15s, feat input: 2.33s, model run: 7.25s,                    loss and opt: 21.53s, update mem: 1.24s update mailbox: 1.64s
feat_buffer time: IO load: 1.479s 异步阻塞: 0.001s presample and analyze: 0.447s 预采样: 0.000s, 预采样负采样:0.134s              记忆刷入和更新:0.233s 纯刷入时间:0.000s 负采样分析: 0.078s
total loop use time: 59.5267
run batch2741total time: 59.13s,presample: 2.41s, sample: 1.47s, prep time: 13.72s, gen block: 5.68s, feat input: 3.20s, model run: 9.96s,               loss and opt: 29.54s, update mem: 1.70s update mailbox: 2.24s
	train loss:2989901.2248  val ap:0.952247  val auc:0.946496, eval time: 31.33
Epoch 4:
IO load: 1.934s presample and analyze: 0.469s 预采样: 0.000s, 预采样负采样:0.154s
第一个块的加载时间: 0.683s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.305s 异步阻塞: 0.000s presample and analyze: 0.397s 预采样: 0.000s, 预采样负采样:0.038s              记忆刷入和更新:0.268s 纯刷入时间:0.000s 负采样分析: 0.090s
平均每个batch用时0.02232s, 预计epoch时间: 61.198s
run batch1000total time: 22.32s,presample: 1.49s, sample: 0.53s, prep time: 4.99s, gen block: 2.07s, feat input: 1.14s, model run: 3.62s,                    loss and opt: 10.94s, update mem: 0.62s update mailbox: 0.83s
feat_buffer time: IO load: 1.036s 异步阻塞: 0.000s presample and analyze: 0.450s 预采样: 0.000s, 预采样负采样:0.090s              记忆刷入和更新:0.268s 纯刷入时间:0.000s 负采样分析: 0.090s
平均每个batch用时0.02252s, 预计epoch时间: 61.740s
run batch2000total time: 44.84s,presample: 2.32s, sample: 1.09s, prep time: 10.24s, gen block: 4.22s, feat input: 2.34s, model run: 7.40s,                    loss and opt: 22.28s, update mem: 1.29s update mailbox: 1.70s
feat_buffer time: IO load: 1.807s 异步阻塞: 0.001s presample and analyze: 0.503s 预采样: 0.000s, 预采样负采样:0.142s              记忆刷入和更新:0.268s 纯刷入时间:0.000s 负采样分析: 0.090s
total loop use time: 61.9211
run batch2741total time: 61.48s,presample: 2.96s, sample: 1.50s, prep time: 14.12s, gen block: 5.82s, feat input: 3.24s, model run: 10.19s,               loss and opt: 30.64s, update mem: 1.78s update mailbox: 2.35s
	train loss:2934636.9950  val ap:0.953501  val auc:0.947723, eval time: 30.45
Epoch 5:
IO load: 2.418s presample and analyze: 0.527s 预采样: 0.000s, 预采样负采样:0.164s
第一个块的加载时间: 0.852s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.466s 异步阻塞: 0.000s presample and analyze: 0.407s 预采样: 0.000s, 预采样负采样:0.041s              记忆刷入和更新:0.260s 纯刷入时间:0.000s 负采样分析: 0.105s
平均每个batch用时0.02247s, 预计epoch时间: 61.607s
run batch1000total time: 22.47s,presample: 1.50s, sample: 0.55s, prep time: 5.06s, gen block: 2.09s, feat input: 1.18s, model run: 3.71s,                    loss and opt: 10.90s, update mem: 0.63s update mailbox: 0.82s
feat_buffer time: IO load: 1.039s 异步阻塞: 0.000s presample and analyze: 0.459s 预采样: 0.000s, 预采样负采样:0.092s              记忆刷入和更新:0.260s 纯刷入时间:0.000s 负采样分析: 0.105s
平均每个batch用时0.02197s, 预计epoch时间: 60.221s
run batch2000total time: 44.44s,presample: 2.15s, sample: 1.10s, prep time: 10.23s, gen block: 4.22s, feat input: 2.40s, model run: 7.47s,                    loss and opt: 21.96s, update mem: 1.26s update mailbox: 1.67s
feat_buffer time: IO load: 1.635s 异步阻塞: 0.001s presample and analyze: 0.511s 预采样: 0.000s, 预采样负采样:0.143s              记忆刷入和更新:0.260s 纯刷入时间:0.000s 负采样分析: 0.105s
total loop use time: 61.1609
run batch2741total time: 60.69s,presample: 2.65s, sample: 1.51s, prep time: 14.03s, gen block: 5.79s, feat input: 3.29s, model run: 10.30s,               loss and opt: 30.14s, update mem: 1.73s update mailbox: 2.28s
	train loss:2925264.3079  val ap:0.952821  val auc:0.946638, eval time: 30.05
Epoch 6:
IO load: 2.106s presample and analyze: 0.532s 预采样: 0.000s, 预采样负采样:0.163s
第一个块的加载时间: 0.661s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.300s 异步阻塞: 0.000s presample and analyze: 0.378s 预采样: 0.000s, 预采样负采样:0.034s              记忆刷入和更新:0.256s 纯刷入时间:0.000s 负采样分析: 0.088s
平均每个batch用时0.02259s, 预计epoch时间: 61.926s
run batch1000total time: 22.59s,presample: 1.30s, sample: 0.55s, prep time: 5.16s, gen block: 2.13s, feat input: 1.21s, model run: 3.76s,                    loss and opt: 11.06s, update mem: 0.63s update mailbox: 0.84s
feat_buffer time: IO load: 0.866s 异步阻塞: 0.000s presample and analyze: 0.430s 预采样: 0.000s, 预采样负采样:0.084s              记忆刷入和更新:0.256s 纯刷入时间:0.000s 负采样分析: 0.088s
平均每个batch用时0.02220s, 预计epoch时间: 60.876s
run batch2000total time: 44.79s,presample: 1.96s, sample: 1.13s, prep time: 10.42s, gen block: 4.30s, feat input: 2.43s, model run: 7.61s,                    loss and opt: 22.15s, update mem: 1.28s update mailbox: 1.70s
feat_buffer time: IO load: 1.466s 异步阻塞: 0.000s presample and analyze: 0.484s 预采样: 0.000s, 预采样负采样:0.137s              记忆刷入和更新:0.256s 纯刷入时间:0.000s 负采样分析: 0.088s
total loop use time: 61.3391
run batch2741total time: 60.91s,presample: 2.47s, sample: 1.54s, prep time: 14.22s, gen block: 5.87s, feat input: 3.32s, model run: 10.38s,               loss and opt: 30.22s, update mem: 1.75s update mailbox: 2.32s
	train loss:2914284.6340  val ap:0.953960  val auc:0.948027, eval time: 31.50
Epoch 7:
IO load: 1.948s presample and analyze: 0.506s 预采样: 0.000s, 预采样负采样:0.158s
第一个块的加载时间: 0.721s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.367s 异步阻塞: 0.000s presample and analyze: 0.371s 预采样: 0.000s, 预采样负采样:0.033s              记忆刷入和更新:0.252s 纯刷入时间:0.000s 负采样分析: 0.087s
平均每个batch用时0.02235s, 预计epoch时间: 61.274s
run batch1000total time: 22.35s,presample: 1.36s, sample: 0.55s, prep time: 5.08s, gen block: 2.09s, feat input: 1.18s, model run: 3.70s,                    loss and opt: 10.91s, update mem: 0.63s update mailbox: 0.84s
feat_buffer time: IO load: 0.931s 异步阻塞: 0.000s presample and analyze: 0.423s 预采样: 0.000s, 预采样负采样:0.083s              记忆刷入和更新:0.252s 纯刷入时间:0.000s 负采样分析: 0.087s
平均每个batch用时0.02116s, 预计epoch时间: 58.018s
run batch2000total time: 43.51s,presample: 1.99s, sample: 1.08s, prep time: 10.05s, gen block: 4.14s, feat input: 2.35s, model run: 7.30s,                    loss and opt: 21.61s, update mem: 1.24s update mailbox: 1.65s
feat_buffer time: IO load: 1.508s 异步阻塞: 0.000s presample and analyze: 0.475s 预采样: 0.000s, 预采样负采样:0.134s              记忆刷入和更新:0.252s 纯刷入时间:0.000s 负采样分析: 0.087s
total loop use time: 59.7898
run batch2741total time: 59.34s,presample: 2.47s, sample: 1.47s, prep time: 13.76s, gen block: 5.67s, feat input: 3.22s, model run: 9.99s,               loss and opt: 29.62s, update mem: 1.71s update mailbox: 2.26s
	train loss:2866527.2062  val ap:0.954840  val auc:0.948965, eval time: 30.29
Epoch 8:
IO load: 1.962s presample and analyze: 0.496s 预采样: 0.000s, 预采样负采样:0.154s
第一个块的加载时间: 0.709s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.359s 异步阻塞: 0.000s presample and analyze: 0.368s 预采样: 0.000s, 预采样负采样:0.033s              记忆刷入和更新:0.249s 纯刷入时间:0.000s 负采样分析: 0.086s
平均每个batch用时0.02233s, 预计epoch时间: 61.216s
run batch1000total time: 22.33s,presample: 1.36s, sample: 0.55s, prep time: 5.06s, gen block: 2.09s, feat input: 1.17s, model run: 3.73s,                    loss and opt: 10.89s, update mem: 0.63s update mailbox: 0.83s
feat_buffer time: IO load: 0.932s 异步阻塞: 0.000s presample and analyze: 0.420s 预采样: 0.000s, 预采样负采样:0.084s              记忆刷入和更新:0.249s 纯刷入时间:0.000s 负采样分析: 0.086s
平均每个batch用时0.02153s, 预计epoch时间: 59.023s
run batch2000total time: 43.86s,presample: 2.02s, sample: 1.09s, prep time: 10.11s, gen block: 4.16s, feat input: 2.35s, model run: 7.40s,                    loss and opt: 21.75s, update mem: 1.26s update mailbox: 1.66s
feat_buffer time: IO load: 1.542s 异步阻塞: 0.000s presample and analyze: 0.471s 预采样: 0.000s, 预采样负采样:0.134s              记忆刷入和更新:0.249s 纯刷入时间:0.000s 负采样分析: 0.086s
total loop use time: 60.3756
run batch2741total time: 59.94s,presample: 2.52s, sample: 1.49s, prep time: 13.88s, gen block: 5.72s, feat input: 3.24s, model run: 10.14s,               loss and opt: 29.86s, update mem: 1.72s update mailbox: 2.28s
	train loss:2873513.8729  val ap:0.955407  val auc:0.949593, eval time: 30.49
Epoch 9:
IO load: 2.012s presample and analyze: 0.493s 预采样: 0.000s, 预采样负采样:0.155s
第一个块的加载时间: 0.655s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.328s 异步阻塞: 0.000s presample and analyze: 0.344s 预采样: 0.000s, 预采样负采样:0.033s              记忆刷入和更新:0.232s 纯刷入时间:0.000s 负采样分析: 0.079s
平均每个batch用时0.02226s, 预计epoch时间: 61.028s
run batch1000total time: 22.26s,presample: 1.36s, sample: 0.57s, prep time: 5.11s, gen block: 2.11s, feat input: 1.19s, model run: 3.77s,                    loss and opt: 10.70s, update mem: 0.64s update mailbox: 0.83s
feat_buffer time: IO load: 0.962s 异步阻塞: 0.000s presample and analyze: 0.395s 预采样: 0.000s, 预采样负采样:0.083s              记忆刷入和更新:0.232s 纯刷入时间:0.000s 负采样分析: 0.079s
平均每个batch用时0.02048s, 预计epoch时间: 56.153s
run batch2000total time: 42.74s,presample: 2.02s, sample: 1.09s, prep time: 9.95s, gen block: 4.12s, feat input: 2.33s, model run: 7.31s,                    loss and opt: 20.90s, update mem: 1.24s update mailbox: 1.61s
feat_buffer time: IO load: 1.564s 异步阻塞: 0.000s presample and analyze: 0.448s 预采样: 0.000s, 预采样负采样:0.135s              记忆刷入和更新:0.232s 纯刷入时间:0.000s 负采样分析: 0.079s
total loop use time: 58.6829
run batch2741total time: 58.29s,presample: 2.55s, sample: 1.49s, prep time: 13.60s, gen block: 5.63s, feat input: 3.19s, model run: 9.98s,               loss and opt: 28.66s, update mem: 1.69s update mailbox: 2.20s
	train loss:2868697.9569  val ap:0.955753  val auc:0.949855, eval time: 30.76
Loading model at epoch 9...
	test AP:0.907472  test AUC:0.890194
训练完成，退出子进程
