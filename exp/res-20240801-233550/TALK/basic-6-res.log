训练配置: {'use_valid_edge': False, 'use_ayscn_prefetch': True, 'pre_sample_size': 600000, 'part_neg_sample': False}
Sent: init_feats
Received: None
Epoch 0:
IO load: 0.000s presample and analyze: 0.000s 预采样: 0.000s, 预采样负采样:0.000s
第一个块的加载时间: 1.666s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.298s 异步阻塞: 0.000s presample and analyze: 1.386s 预采样: 0.000s, 预采样负采样:0.037s              记忆刷入和更新:0.245s 纯刷入时间:0.000s 负采样分析: 1.105s
平均每个batch用时0.02439s, 预计epoch时间: 66.858s
run batch1000total time: 24.39s,presample: 2.29s, sample: 0.54s, prep time: 5.09s, gen block: 2.12s, feat input: 1.20s, model run: 4.86s,                    loss and opt: 10.85s, update mem: 0.62s update mailbox: 0.82s
feat_buffer time: IO load: 0.848s 异步阻塞: 0.000s presample and analyze: 1.441s 预采样: 0.000s, 预采样负采样:0.090s              记忆刷入和更新:0.245s 纯刷入时间:0.000s 负采样分析: 1.105s
平均每个batch用时0.02171s, 预计epoch时间: 59.525s
run batch2000total time: 46.10s,presample: 2.93s, sample: 1.08s, prep time: 10.22s, gen block: 4.24s, feat input: 2.41s, model run: 8.60s,                    loss and opt: 21.76s, update mem: 1.25s update mailbox: 1.65s
feat_buffer time: IO load: 1.430s 异步阻塞: 0.001s presample and analyze: 1.493s 预采样: 0.000s, 预采样负采样:0.141s              记忆刷入和更新:0.245s 纯刷入时间:0.000s 负采样分析: 1.105s
total loop use time: 62.8742
run batch2741total time: 62.47s,presample: 3.44s, sample: 1.50s, prep time: 14.08s, gen block: 5.84s, feat input: 3.32s, model run: 11.44s,               loss and opt: 29.94s, update mem: 1.72s update mailbox: 2.28s
	train loss:3602113.2463  val ap:0.945454  val auc:0.939175, eval time: 29.24
Epoch 1:
IO load: 1.914s presample and analyze: 1.515s 预采样: 0.000s, 预采样负采样:0.162s
第一个块的加载时间: 0.662s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.304s 异步阻塞: 0.000s presample and analyze: 0.381s 预采样: 0.000s, 预采样负采样:0.039s              记忆刷入和更新:0.253s 纯刷入时间:0.000s 负采样分析: 0.088s
平均每个batch用时0.02289s, 预计epoch时间: 62.759s
run batch1000total time: 22.89s,presample: 1.46s, sample: 0.54s, prep time: 5.12s, gen block: 2.13s, feat input: 1.17s, model run: 3.74s,                    loss and opt: 11.23s, update mem: 0.63s update mailbox: 0.85s
feat_buffer time: IO load: 1.024s 异步阻塞: 0.000s presample and analyze: 0.436s 预采样: 0.000s, 预采样负采样:0.092s              记忆刷入和更新:0.253s 纯刷入时间:0.000s 负采样分析: 0.088s
平均每个batch用时0.02206s, 预计epoch时间: 60.491s
run batch2000total time: 44.95s,presample: 2.29s, sample: 1.09s, prep time: 10.25s, gen block: 4.25s, feat input: 2.34s, model run: 7.47s,                    loss and opt: 22.31s, update mem: 1.28s update mailbox: 1.69s
feat_buffer time: IO load: 1.786s 异步阻塞: 0.001s presample and analyze: 0.491s 预采样: 0.000s, 预采样负采样:0.145s              记忆刷入和更新:0.253s 纯刷入时间:0.000s 负采样分析: 0.088s
total loop use time: 61.7761
run batch2741total time: 61.34s,presample: 2.93s, sample: 1.49s, prep time: 14.05s, gen block: 5.82s, feat input: 3.23s, model run: 10.26s,               loss and opt: 30.49s, update mem: 1.75s update mailbox: 2.31s
	train loss:3140702.4255  val ap:0.948685  val auc:0.942920, eval time: 33.57
Epoch 2:
IO load: 2.403s presample and analyze: 0.514s 预采样: 0.000s, 预采样负采样:0.167s
第一个块的加载时间: 0.780s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.394s 异步阻塞: 0.000s presample and analyze: 0.403s 预采样: 0.000s, 预采样负采样:0.034s              记忆刷入和更新:0.275s 纯刷入时间:0.000s 负采样分析: 0.095s
平均每个batch用时0.02213s, 预计epoch时间: 60.682s
run batch1000total time: 22.13s,presample: 1.58s, sample: 0.52s, prep time: 4.94s, gen block: 2.04s, feat input: 1.14s, model run: 3.58s,                    loss and opt: 10.78s, update mem: 0.62s update mailbox: 0.82s
feat_buffer time: IO load: 1.114s 异步阻塞: 0.000s presample and analyze: 0.458s 预采样: 0.000s, 预采样负采样:0.087s              记忆刷入和更新:0.275s 纯刷入时间:0.000s 负采样分析: 0.095s
平均每个batch用时0.02198s, 预计epoch时间: 60.267s
run batch2000total time: 44.12s,presample: 2.40s, sample: 1.07s, prep time: 10.08s, gen block: 4.16s, feat input: 2.32s, model run: 7.28s,                    loss and opt: 21.79s, update mem: 1.27s update mailbox: 1.66s
feat_buffer time: IO load: 1.881s 异步阻塞: 0.001s presample and analyze: 0.512s 预采样: 0.000s, 预采样负采样:0.139s              记忆刷入和更新:0.275s 纯刷入时间:0.000s 负采样分析: 0.095s
total loop use time: 61.3253
run batch2741total time: 60.86s,presample: 3.03s, sample: 1.49s, prep time: 13.99s, gen block: 5.77s, feat input: 3.23s, model run: 10.11s,               loss and opt: 30.18s, update mem: 1.76s update mailbox: 2.31s
	train loss:3044636.3755  val ap:0.949141  val auc:0.943082, eval time: 29.11
Epoch 3:
IO load: 2.481s presample and analyze: 0.534s 预采样: 0.000s, 预采样负采样:0.161s
第一个块的加载时间: 0.680s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.302s 异步阻塞: 0.000s presample and analyze: 0.395s 预采样: 0.000s, 预采样负采样:0.033s              记忆刷入和更新:0.271s 纯刷入时间:0.000s 负采样分析: 0.091s
平均每个batch用时0.02278s, 预计epoch时间: 62.459s
run batch1000total time: 22.78s,presample: 1.49s, sample: 0.55s, prep time: 5.16s, gen block: 2.14s, feat input: 1.19s, model run: 3.78s,                    loss and opt: 11.03s, update mem: 0.64s update mailbox: 0.85s
feat_buffer time: IO load: 1.034s 异步阻塞: 0.000s presample and analyze: 0.450s 预采样: 0.000s, 预采样负采样:0.086s              记忆刷入和更新:0.271s 纯刷入时间:0.000s 负采样分析: 0.091s
平均每个batch用时0.02191s, 预计epoch时间: 60.067s
run batch2000total time: 44.69s,presample: 2.33s, sample: 1.10s, prep time: 10.30s, gen block: 4.25s, feat input: 2.38s, model run: 7.50s,                    loss and opt: 21.94s, update mem: 1.28s update mailbox: 1.70s
feat_buffer time: IO load: 1.816s 异步阻塞: 0.001s presample and analyze: 0.505s 预采样: 0.000s, 预采样负采样:0.139s              记忆刷入和更新:0.271s 纯刷入时间:0.000s 负采样分析: 0.091s
total loop use time: 61.5574
run batch2741total time: 61.12s,presample: 2.97s, sample: 1.50s, prep time: 14.14s, gen block: 5.84s, feat input: 3.27s, model run: 10.29s,               loss and opt: 30.13s, update mem: 1.76s update mailbox: 2.33s
	train loss:2984686.5195  val ap:0.950621  val auc:0.944648, eval time: 28.97
Epoch 4:
IO load: 2.430s presample and analyze: 0.528s 预采样: 0.000s, 预采样负采样:0.162s
第一个块的加载时间: 0.643s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.264s 异步阻塞: 0.000s presample and analyze: 0.393s 预采样: 0.000s, 预采样负采样:0.027s              记忆刷入和更新:0.269s 纯刷入时间:0.000s 负采样分析: 0.097s
平均每个batch用时0.02291s, 预计epoch时间: 62.798s
run batch1000total time: 22.91s,presample: 1.41s, sample: 0.55s, prep time: 5.16s, gen block: 2.14s, feat input: 1.19s, model run: 3.75s,                    loss and opt: 11.25s, update mem: 0.64s update mailbox: 0.85s
feat_buffer time: IO load: 0.970s 异步阻塞: 0.000s presample and analyze: 0.440s 预采样: 0.000s, 预采样负采样:0.073s              记忆刷入和更新:0.269s 纯刷入时间:0.000s 负采样分析: 0.097s
平均每个batch用时0.02273s, 预计epoch时间: 62.310s
run batch2000total time: 45.63s,presample: 2.24s, sample: 1.12s, prep time: 10.47s, gen block: 4.33s, feat input: 2.42s, model run: 7.60s,                    loss and opt: 22.64s, update mem: 1.31s update mailbox: 1.73s
feat_buffer time: IO load: 1.737s 异步阻塞: 0.001s presample and analyze: 0.494s 预采样: 0.000s, 预采样负采样:0.125s              记忆刷入和更新:0.269s 纯刷入时间:0.000s 负采样分析: 0.097s
total loop use time: 62.6608
run batch2741total time: 62.24s,presample: 2.87s, sample: 1.53s, prep time: 14.36s, gen block: 5.94s, feat input: 3.32s, model run: 10.41s,               loss and opt: 30.95s, update mem: 1.79s update mailbox: 2.36s
	train loss:2941135.8944  val ap:0.952502  val auc:0.946468, eval time: 29.93
Epoch 5:
IO load: 2.340s presample and analyze: 0.517s 预采样: 0.000s, 预采样负采样:0.148s
第一个块的加载时间: 0.686s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.307s 异步阻塞: 0.000s presample and analyze: 0.396s 预采样: 0.000s, 预采样负采样:0.034s              记忆刷入和更新:0.268s 纯刷入时间:0.000s 负采样分析: 0.094s
平均每个batch用时0.02307s, 预计epoch时间: 63.254s
run batch1000total time: 23.07s,presample: 1.50s, sample: 0.56s, prep time: 5.23s, gen block: 2.16s, feat input: 1.20s, model run: 3.82s,                    loss and opt: 11.19s, update mem: 0.66s update mailbox: 0.87s
feat_buffer time: IO load: 1.041s 异步阻塞: 0.000s presample and analyze: 0.450s 预采样: 0.000s, 预采样负采样:0.086s              记忆刷入和更新:0.268s 纯刷入时间:0.000s 负采样分析: 0.094s
平均每个batch用时0.02203s, 预计epoch时间: 60.404s
run batch2000total time: 45.10s,presample: 2.34s, sample: 1.12s, prep time: 10.40s, gen block: 4.29s, feat input: 2.39s, model run: 7.59s,                    loss and opt: 22.13s, update mem: 1.31s update mailbox: 1.72s
feat_buffer time: IO load: 1.826s 异步阻塞: 0.001s presample and analyze: 0.505s 预采样: 0.000s, 预采样负采样:0.139s              记忆刷入和更新:0.268s 纯刷入时间:0.000s 负采样分析: 0.094s
total loop use time: 61.7446
run batch2741total time: 61.31s,presample: 2.98s, sample: 1.51s, prep time: 14.14s, gen block: 5.84s, feat input: 3.25s, model run: 10.42s,               loss and opt: 30.17s, update mem: 1.77s update mailbox: 2.34s
	train loss:2915688.2859  val ap:0.952799  val auc:0.946770, eval time: 28.95
Epoch 6:
IO load: 2.439s presample and analyze: 0.527s 预采样: 0.000s, 预采样负采样:0.161s
第一个块的加载时间: 0.747s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.365s 异步阻塞: 0.000s presample and analyze: 0.398s 预采样: 0.000s, 预采样负采样:0.034s              记忆刷入和更新:0.273s 纯刷入时间:0.000s 负采样分析: 0.091s
平均每个batch用时0.02312s, 预计epoch时间: 63.395s
run batch1000total time: 23.12s,presample: 1.54s, sample: 0.55s, prep time: 5.22s, gen block: 2.16s, feat input: 1.21s, model run: 3.79s,                    loss and opt: 11.24s, update mem: 0.65s update mailbox: 0.86s
feat_buffer time: IO load: 1.084s 异步阻塞: 0.000s presample and analyze: 0.451s 预采样: 0.000s, 预采样负采样:0.086s              记忆刷入和更新:0.273s 纯刷入时间:0.000s 负采样分析: 0.091s
平均每个batch用时0.02233s, 预计epoch时间: 61.218s
run batch2000total time: 45.45s,presample: 2.37s, sample: 1.10s, prep time: 10.45s, gen block: 4.33s, feat input: 2.42s, model run: 7.57s,                    loss and opt: 22.41s, update mem: 1.30s update mailbox: 1.72s
feat_buffer time: IO load: 1.853s 异步阻塞: 0.001s presample and analyze: 0.506s 预采样: 0.000s, 预采样负采样:0.139s              记忆刷入和更新:0.273s 纯刷入时间:0.000s 负采样分析: 0.091s
total loop use time: 62.3923
run batch2741total time: 61.96s,presample: 3.00s, sample: 1.51s, prep time: 14.31s, gen block: 5.92s, feat input: 3.32s, model run: 10.36s,               loss and opt: 30.66s, update mem: 1.78s update mailbox: 2.35s
	train loss:2896656.3778  val ap:0.953323  val auc:0.947469, eval time: 25.10
Epoch 7:
IO load: 2.456s presample and analyze: 0.529s 预采样: 0.000s, 预采样负采样:0.161s
第一个块的加载时间: 0.677s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.311s 异步阻塞: 0.000s presample and analyze: 0.382s 预采样: 0.000s, 预采样负采样:0.032s              记忆刷入和更新:0.260s 纯刷入时间:0.000s 负采样分析: 0.090s
平均每个batch用时0.02233s, 预计epoch时间: 61.232s
run batch1000total time: 22.33s,presample: 1.47s, sample: 0.53s, prep time: 5.06s, gen block: 2.09s, feat input: 1.17s, model run: 3.63s,                    loss and opt: 10.88s, update mem: 0.63s update mailbox: 0.84s
feat_buffer time: IO load: 1.032s 异步阻塞: 0.000s presample and analyze: 0.432s 预采样: 0.000s, 预采样负采样:0.080s              记忆刷入和更新:0.260s 纯刷入时间:0.000s 负采样分析: 0.090s
平均每个batch用时0.02166s, 预计epoch时间: 59.390s
run batch2000total time: 44.00s,presample: 2.30s, sample: 1.07s, prep time: 10.14s, gen block: 4.19s, feat input: 2.33s, model run: 7.27s,                    loss and opt: 21.72s, update mem: 1.27s update mailbox: 1.67s
feat_buffer time: IO load: 1.810s 异步阻塞: 0.001s presample and analyze: 0.486s 预采样: 0.000s, 预采样负采样:0.134s              记忆刷入和更新:0.260s 纯刷入时间:0.000s 负采样分析: 0.090s
total loop use time: 60.7996
run batch2741total time: 60.37s,presample: 2.94s, sample: 1.48s, prep time: 13.97s, gen block: 5.78s, feat input: 3.22s, model run: 10.05s,               loss and opt: 29.87s, update mem: 1.74s update mailbox: 2.30s
	train loss:2894434.4841  val ap:0.954163  val auc:0.948325, eval time: 27.33
Epoch 8:
IO load: 2.422s presample and analyze: 0.509s 预采样: 0.000s, 预采样负采样:0.156s
第一个块的加载时间: 0.722s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.336s 异步阻塞: 0.000s presample and analyze: 0.403s 预采样: 0.000s, 预采样负采样:0.034s              记忆刷入和更新:0.275s 纯刷入时间:0.000s 负采样分析: 0.093s
平均每个batch用时0.02318s, 预计epoch时间: 63.553s
run batch1000total time: 23.18s,presample: 1.53s, sample: 0.56s, prep time: 5.23s, gen block: 2.16s, feat input: 1.20s, model run: 3.80s,                    loss and opt: 11.28s, update mem: 0.66s update mailbox: 0.87s
feat_buffer time: IO load: 1.071s 异步阻塞: 0.000s presample and analyze: 0.458s 预采样: 0.000s, 预采样负采样:0.088s              记忆刷入和更新:0.275s 纯刷入时间:0.000s 负采样分析: 0.093s
平均每个batch用时0.02228s, 预计epoch时间: 61.074s
run batch2000total time: 45.46s,presample: 2.38s, sample: 1.11s, prep time: 10.43s, gen block: 4.32s, feat input: 2.41s, model run: 7.58s,                    loss and opt: 22.42s, update mem: 1.30s update mailbox: 1.72s
feat_buffer time: IO load: 1.853s 异步阻塞: 0.001s presample and analyze: 0.513s 预采样: 0.000s, 预采样负采样:0.141s              记忆刷入和更新:0.275s 纯刷入时间:0.000s 负采样分析: 0.093s
total loop use time: 62.3206
run batch2741total time: 61.87s,presample: 3.01s, sample: 1.51s, prep time: 14.24s, gen block: 5.89s, feat input: 3.29s, model run: 10.34s,               loss and opt: 30.66s, update mem: 1.78s update mailbox: 2.34s
	train loss:2886131.8636  val ap:0.954502  val auc:0.948295, eval time: 25.86
Epoch 9:
IO load: 2.466s presample and analyze: 0.536s 预采样: 0.000s, 预采样负采样:0.163s
第一个块的加载时间: 0.636s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.266s 异步阻塞: 0.000s presample and analyze: 0.384s 预采样: 0.000s, 预采样负采样:0.027s              记忆刷入和更新:0.267s 纯刷入时间:0.000s 负采样分析: 0.089s
平均每个batch用时0.02358s, 预计epoch时间: 64.658s
run batch1000total time: 23.58s,presample: 1.43s, sample: 0.58s, prep time: 5.34s, gen block: 2.20s, feat input: 1.21s, model run: 3.90s,                    loss and opt: 11.55s, update mem: 0.68s update mailbox: 0.89s
feat_buffer time: IO load: 0.991s 异步阻塞: 0.000s presample and analyze: 0.437s 预采样: 0.000s, 预采样负采样:0.079s              记忆刷入和更新:0.267s 纯刷入时间:0.000s 负采样分析: 0.089s
平均每个batch用时0.02235s, 预计epoch时间: 61.284s
run batch2000total time: 45.94s,presample: 2.27s, sample: 1.13s, prep time: 10.58s, gen block: 4.37s, feat input: 2.43s, model run: 7.69s,                    loss and opt: 22.71s, update mem: 1.33s update mailbox: 1.75s
feat_buffer time: IO load: 1.767s 异步阻塞: 0.001s presample and analyze: 0.491s 预采样: 0.000s, 预采样负采样:0.131s              记忆刷入和更新:0.267s 纯刷入时间:0.000s 负采样分析: 0.089s
total loop use time: 62.8550
run batch2741total time: 62.44s,presample: 2.90s, sample: 1.53s, prep time: 14.43s, gen block: 5.96s, feat input: 3.33s, model run: 10.48s,               loss and opt: 30.96s, update mem: 1.81s update mailbox: 2.38s
	train loss:2856536.6985  val ap:0.953266  val auc:0.946846, eval time: 28.15
Loading model at epoch 8...
	test AP:0.925075  test AUC:0.911867
训练完成，退出子进程
