训练配置: {'use_valid_edge': False, 'use_ayscn_prefetch': True, 'pre_sample_size': 600000, 'part_neg_sample': False}
Sent: init_feats
Received: None
Epoch 0:
IO load: 0.000s presample and analyze: 0.000s 预采样: 0.000s, 预采样负采样:0.000s
第一个块的加载时间: 1.821s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.333s 异步阻塞: 0.000s presample and analyze: 1.507s 预采样: 0.000s, 预采样负采样:0.042s              记忆刷入和更新:0.221s 纯刷入时间:0.000s 负采样分析: 1.243s
平均每个batch用时0.02204s, 预计epoch时间: 60.415s
run batch1000total time: 22.04s,presample: 2.48s, sample: 0.49s, prep time: 4.53s, gen block: 1.87s, feat input: 1.05s, model run: 4.52s,                    loss and opt: 9.34s, update mem: 0.56s update mailbox: 0.74s
feat_buffer time: IO load: 0.912s 异步阻塞: 0.000s presample and analyze: 1.565s 预采样: 0.000s, 预采样负采样:0.098s              记忆刷入和更新:0.221s 纯刷入时间:0.000s 负采样分析: 1.243s
平均每个batch用时0.02074s, 预计epoch时间: 56.873s
run batch2000total time: 42.78s,presample: 3.13s, sample: 1.01s, prep time: 9.39s, gen block: 3.88s, feat input: 2.20s, model run: 8.08s,                    loss and opt: 19.79s, update mem: 1.16s update mailbox: 1.52s
feat_buffer time: IO load: 1.502s 异步阻塞: 0.001s presample and analyze: 1.618s 预采样: 0.000s, 预采样负采样:0.150s              记忆刷入和更新:0.221s 纯刷入时间:0.000s 负采样分析: 1.243s
total loop use time: 58.9122
run batch2741total time: 58.48s,presample: 3.62s, sample: 1.40s, prep time: 13.10s, gen block: 5.40s, feat input: 3.07s, model run: 10.77s,               loss and opt: 27.65s, update mem: 1.61s update mailbox: 2.13s
	train loss:3566187.7330  val ap:0.941017  val auc:0.934627, eval time: 30.64
Epoch 1:
IO load: 1.968s presample and analyze: 1.641s 预采样: 0.000s, 预采样负采样:0.172s
第一个块的加载时间: 0.826s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.449s 异步阻塞: 0.000s presample and analyze: 0.397s 预采样: 0.000s, 预采样负采样:0.041s              记忆刷入和更新:0.266s 纯刷入时间:0.000s 负采样分析: 0.090s
平均每个batch用时0.02290s, 预计epoch时间: 62.784s
run batch1000total time: 22.90s,presample: 1.47s, sample: 0.57s, prep time: 5.22s, gen block: 2.16s, feat input: 1.22s, model run: 3.86s,                    loss and opt: 11.02s, update mem: 0.64s update mailbox: 0.85s
feat_buffer time: IO load: 1.014s 异步阻塞: 0.000s presample and analyze: 0.450s 预采样: 0.000s, 预采样负采样:0.092s              记忆刷入和更新:0.266s 纯刷入时间:0.000s 负采样分析: 0.090s
平均每个batch用时0.02168s, 预计epoch时间: 59.439s
run batch2000total time: 44.58s,presample: 2.13s, sample: 1.12s, prep time: 10.36s, gen block: 4.28s, feat input: 2.44s, model run: 7.62s,                    loss and opt: 21.83s, update mem: 1.27s update mailbox: 1.69s
feat_buffer time: IO load: 1.616s 异步阻塞: 0.001s presample and analyze: 0.503s 预采样: 0.000s, 预采样负采样:0.144s              记忆刷入和更新:0.266s 纯刷入时间:0.000s 负采样分析: 0.090s
total loop use time: 61.0535
run batch2741total time: 60.64s,presample: 2.63s, sample: 1.52s, prep time: 14.16s, gen block: 5.85s, feat input: 3.34s, model run: 10.40s,               loss and opt: 29.85s, update mem: 1.73s update mailbox: 2.30s
	train loss:3143280.4455  val ap:0.948353  val auc:0.942552, eval time: 29.70
Epoch 2:
IO load: 2.092s presample and analyze: 0.526s 预采样: 0.000s, 预采样负采样:0.166s
第一个块的加载时间: 0.619s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.295s 异步阻塞: 0.000s presample and analyze: 0.339s 预采样: 0.000s, 预采样负采样:0.027s              记忆刷入和更新:0.232s 纯刷入时间:0.000s 负采样分析: 0.079s
平均每个batch用时0.02197s, 预计epoch时间: 60.231s
run batch1000total time: 21.97s,presample: 1.23s, sample: 0.53s, prep time: 4.99s, gen block: 2.07s, feat input: 1.17s, model run: 3.64s,                    loss and opt: 10.84s, update mem: 0.62s update mailbox: 0.81s
feat_buffer time: IO load: 0.831s 异步阻塞: 0.000s presample and analyze: 0.391s 预采样: 0.000s, 预采样负采样:0.078s              记忆刷入和更新:0.232s 纯刷入时间:0.000s 负采样分析: 0.079s
平均每个batch用时0.02193s, 预计epoch时间: 60.116s
run batch2000total time: 43.90s,presample: 1.86s, sample: 1.09s, prep time: 10.16s, gen block: 4.20s, feat input: 2.37s, model run: 7.38s,                    loss and opt: 21.91s, update mem: 1.25s update mailbox: 1.66s
feat_buffer time: IO load: 1.407s 异步阻塞: 0.001s presample and analyze: 0.443s 预采样: 0.000s, 预采样负采样:0.129s              记忆刷入和更新:0.232s 纯刷入时间:0.000s 负采样分析: 0.079s
total loop use time: 60.2037
run batch2741total time: 59.80s,presample: 2.34s, sample: 1.49s, prep time: 13.90s, gen block: 5.73s, feat input: 3.27s, model run: 10.10s,               loss and opt: 29.94s, update mem: 1.71s update mailbox: 2.27s
	train loss:3018680.2135  val ap:0.951305  val auc:0.945515, eval time: 30.13
Epoch 3:
IO load: 1.860s presample and analyze: 0.465s 预采样: 0.000s, 预采样负采样:0.150s
第一个块的加载时间: 0.673s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.304s 异步阻塞: 0.000s presample and analyze: 0.392s 预采样: 0.000s, 预采样负采样:0.036s              记忆刷入和更新:0.271s 纯刷入时间:0.000s 负采样分析: 0.085s
平均每个batch用时0.02247s, 预计epoch时间: 61.592s
run batch1000total time: 22.47s,presample: 1.31s, sample: 0.56s, prep time: 5.11s, gen block: 2.12s, feat input: 1.20s, model run: 3.75s,                    loss and opt: 10.97s, update mem: 0.62s update mailbox: 0.83s
feat_buffer time: IO load: 0.865s 异步阻塞: 0.000s presample and analyze: 0.445s 预采样: 0.000s, 预采样负采样:0.087s              记忆刷入和更新:0.271s 纯刷入时间:0.000s 负采样分析: 0.085s
平均每个batch用时0.02190s, 预计epoch时间: 60.049s
run batch2000total time: 44.37s,presample: 1.97s, sample: 1.11s, prep time: 10.26s, gen block: 4.24s, feat input: 2.41s, model run: 7.50s,                    loss and opt: 22.02s, update mem: 1.26s update mailbox: 1.67s
feat_buffer time: IO load: 1.462s 异步阻塞: 0.001s presample and analyze: 0.499s 预采样: 0.000s, 预采样负采样:0.140s              记忆刷入和更新:0.271s 纯刷入时间:0.000s 负采样分析: 0.085s
total loop use time: 60.9172
run batch2741total time: 60.51s,presample: 2.46s, sample: 1.51s, prep time: 14.04s, gen block: 5.80s, feat input: 3.31s, model run: 10.25s,               loss and opt: 30.18s, update mem: 1.72s update mailbox: 2.28s
	train loss:2968376.0080  val ap:0.952577  val auc:0.946973, eval time: 30.55
Epoch 4:
IO load: 1.932s presample and analyze: 0.521s 预采样: 0.000s, 预采样负采样:0.161s
第一个块的加载时间: 0.668s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.332s 异步阻塞: 0.000s presample and analyze: 0.353s 预采样: 0.000s, 预采样负采样:0.032s              记忆刷入和更新:0.235s 纯刷入时间:0.000s 负采样分析: 0.085s
平均每个batch用时0.02238s, 预计epoch时间: 61.370s
run batch1000total time: 22.38s,presample: 1.31s, sample: 0.55s, prep time: 5.13s, gen block: 2.12s, feat input: 1.22s, model run: 3.77s,                    loss and opt: 10.88s, update mem: 0.62s update mailbox: 0.83s
feat_buffer time: IO load: 0.898s 异步阻塞: 0.000s presample and analyze: 0.405s 预采样: 0.000s, 预采样负采样:0.084s              记忆刷入和更新:0.235s 纯刷入时间:0.000s 负采样分析: 0.085s
平均每个batch用时0.02182s, 预计epoch时间: 59.831s
run batch2000total time: 44.21s,presample: 1.97s, sample: 1.10s, prep time: 10.29s, gen block: 4.24s, feat input: 2.44s, model run: 7.56s,                    loss and opt: 21.78s, update mem: 1.25s update mailbox: 1.67s
feat_buffer time: IO load: 1.503s 异步阻塞: 0.001s presample and analyze: 0.458s 预采样: 0.000s, 预采样负采样:0.135s              记忆刷入和更新:0.235s 纯刷入时间:0.000s 负采样分析: 0.085s
total loop use time: 60.7495
run batch2741total time: 60.32s,presample: 2.47s, sample: 1.51s, prep time: 14.11s, gen block: 5.82s, feat input: 3.34s, model run: 10.35s,               loss and opt: 29.81s, update mem: 1.72s update mailbox: 2.29s
	train loss:2943453.8255  val ap:0.952975  val auc:0.947342, eval time: 31.91
Epoch 5:
IO load: 1.979s presample and analyze: 0.480s 预采样: 0.000s, 预采样负采样:0.156s
第一个块的加载时间: 0.717s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.329s 异步阻塞: 0.000s presample and analyze: 0.405s 预采样: 0.000s, 预采样负采样:0.034s              记忆刷入和更新:0.276s 纯刷入时间:0.000s 负采样分析: 0.095s
平均每个batch用时0.02263s, 预计epoch时间: 62.049s
run batch1000total time: 22.63s,presample: 1.52s, sample: 0.54s, prep time: 5.08s, gen block: 2.10s, feat input: 1.16s, model run: 3.69s,                    loss and opt: 11.03s, update mem: 0.63s update mailbox: 0.84s
feat_buffer time: IO load: 1.059s 异步阻塞: 0.000s presample and analyze: 0.462s 预采样: 0.000s, 预采样负采样:0.088s              记忆刷入和更新:0.276s 纯刷入时间:0.000s 负采样分析: 0.095s
平均每个batch用时0.02251s, 预计epoch时间: 61.706s
run batch2000total time: 45.14s,presample: 2.35s, sample: 1.10s, prep time: 10.27s, gen block: 4.24s, feat input: 2.36s, model run: 7.61s,                    loss and opt: 22.28s, update mem: 1.29s update mailbox: 1.71s
feat_buffer time: IO load: 1.830s 异步阻塞: 0.001s presample and analyze: 0.515s 预采样: 0.000s, 预采样负采样:0.140s              记忆刷入和更新:0.276s 纯刷入时间:0.000s 负采样分析: 0.095s
total loop use time: 61.9015
run batch2741total time: 61.43s,presample: 3.01s, sample: 1.50s, prep time: 14.06s, gen block: 5.80s, feat input: 3.24s, model run: 10.34s,               loss and opt: 30.44s, update mem: 1.76s update mailbox: 2.33s
	train loss:2921377.8764  val ap:0.954105  val auc:0.948301, eval time: 29.69
Epoch 6:
IO load: 2.465s presample and analyze: 0.539s 预采样: 0.000s, 预采样负采样:0.162s
第一个块的加载时间: 0.665s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.330s 异步阻塞: 0.000s presample and analyze: 0.352s 预采样: 0.000s, 预采样负采样:0.033s              记忆刷入和更新:0.238s 纯刷入时间:0.000s 负采样分析: 0.081s
平均每个batch用时0.02234s, 预计epoch时间: 61.258s
run batch1000total time: 22.34s,presample: 1.29s, sample: 0.54s, prep time: 5.07s, gen block: 2.10s, feat input: 1.19s, model run: 3.70s,                    loss and opt: 10.99s, update mem: 0.62s update mailbox: 0.82s
feat_buffer time: IO load: 0.879s 异步阻塞: 0.000s presample and analyze: 0.403s 预采样: 0.000s, 预采样负采样:0.083s              记忆刷入和更新:0.238s 纯刷入时间:0.000s 负采样分析: 0.081s
平均每个batch用时0.02196s, 预计epoch时间: 60.213s
run batch2000total time: 44.31s,presample: 1.93s, sample: 1.09s, prep time: 10.27s, gen block: 4.25s, feat input: 2.42s, model run: 7.50s,                    loss and opt: 22.00s, update mem: 1.26s update mailbox: 1.67s
feat_buffer time: IO load: 1.466s 异步阻塞: 0.001s presample and analyze: 0.457s 预采样: 0.000s, 预采样负采样:0.135s              记忆刷入和更新:0.238s 纯刷入时间:0.000s 负采样分析: 0.081s
total loop use time: 61.0946
run batch2741total time: 60.66s,presample: 2.46s, sample: 1.51s, prep time: 14.13s, gen block: 5.84s, feat input: 3.32s, model run: 10.32s,               loss and opt: 30.16s, update mem: 1.73s update mailbox: 2.30s
	train loss:2892855.7630  val ap:0.953503  val auc:0.947597, eval time: 29.47
Epoch 7:
IO load: 1.968s presample and analyze: 0.479s 预采样: 0.000s, 预采样负采样:0.156s
第一个块的加载时间: 0.626s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.297s 异步阻塞: 0.000s presample and analyze: 0.343s 预采样: 0.000s, 预采样负采样:0.028s              记忆刷入和更新:0.236s 纯刷入时间:0.000s 负采样分析: 0.080s
平均每个batch用时0.02224s, 预计epoch时间: 60.964s
run batch1000total time: 22.24s,presample: 1.25s, sample: 0.55s, prep time: 5.10s, gen block: 2.11s, feat input: 1.19s, model run: 3.73s,                    loss and opt: 10.86s, update mem: 0.63s update mailbox: 0.83s
feat_buffer time: IO load: 0.849s 异步阻塞: 0.000s presample and analyze: 0.395s 预采样: 0.000s, 预采样负采样:0.078s              记忆刷入和更新:0.236s 纯刷入时间:0.000s 负采样分析: 0.080s
平均每个batch用时0.02138s, 预计epoch时间: 58.628s
run batch2000total time: 43.62s,presample: 1.88s, sample: 1.08s, prep time: 10.15s, gen block: 4.20s, feat input: 2.38s, model run: 7.43s,                    loss and opt: 21.60s, update mem: 1.24s update mailbox: 1.65s
feat_buffer time: IO load: 1.422s 异步阻塞: 0.001s presample and analyze: 0.448s 预采样: 0.000s, 预采样负采样:0.129s              记忆刷入和更新:0.236s 纯刷入时间:0.000s 负采样分析: 0.080s
total loop use time: 59.8932
run batch2741total time: 59.49s,presample: 2.36s, sample: 1.48s, prep time: 13.88s, gen block: 5.74s, feat input: 3.26s, model run: 10.15s,               loss and opt: 29.60s, update mem: 1.70s update mailbox: 2.25s
	train loss:2867962.9775  val ap:0.955060  val auc:0.949412, eval time: 30.75
Epoch 8:
IO load: 1.875s presample and analyze: 0.470s 预采样: 0.000s, 预采样负采样:0.150s
第一个块的加载时间: 0.699s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.351s 异步阻塞: 0.000s presample and analyze: 0.367s 预采样: 0.000s, 预采样负采样:0.035s              记忆刷入和更新:0.247s 纯刷入时间:0.000s 负采样分析: 0.084s
平均每个batch用时0.02284s, 预计epoch时间: 62.620s
run batch1000total time: 22.84s,presample: 1.34s, sample: 0.57s, prep time: 5.24s, gen block: 2.16s, feat input: 1.22s, model run: 3.85s,                    loss and opt: 11.07s, update mem: 0.64s update mailbox: 0.86s
feat_buffer time: IO load: 0.916s 异步阻塞: 0.000s presample and analyze: 0.419s 预采样: 0.000s, 预采样负采样:0.086s              记忆刷入和更新:0.247s 纯刷入时间:0.000s 负采样分析: 0.084s
平均每个batch用时0.01848s, 预计epoch时间: 50.671s
run batch2000total time: 41.32s,presample: 2.00s, sample: 1.05s, prep time: 9.73s, gen block: 4.01s, feat input: 2.27s, model run: 7.14s,                    loss and opt: 19.98s, update mem: 1.20s update mailbox: 1.59s
feat_buffer time: IO load: 1.516s 异步阻塞: 0.001s presample and analyze: 0.472s 预采样: 0.000s, 预采样负采样:0.137s              记忆刷入和更新:0.247s 纯刷入时间:0.000s 负采样分析: 0.084s
total loop use time: 58.2083
run batch2741total time: 57.78s,presample: 2.51s, sample: 1.47s, prep time: 13.60s, gen block: 5.61s, feat input: 3.17s, model run: 10.00s,               loss and opt: 28.20s, update mem: 1.67s update mailbox: 2.22s
	train loss:2853983.8525  val ap:0.955812  val auc:0.950153, eval time: 30.04
Epoch 9:
IO load: 2.005s presample and analyze: 0.493s 预采样: 0.000s, 预采样负采样:0.158s
第一个块的加载时间: 0.791s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.423s 异步阻塞: 0.000s presample and analyze: 0.387s 预采样: 0.000s, 预采样负采样:0.038s              记忆刷入和更新:0.253s 纯刷入时间:0.000s 负采样分析: 0.095s
平均每个batch用时0.02359s, 预计epoch时间: 64.679s
run batch1000total time: 23.59s,presample: 1.61s, sample: 0.58s, prep time: 5.33s, gen block: 2.20s, feat input: 1.21s, model run: 3.89s,                    loss and opt: 11.39s, update mem: 0.67s update mailbox: 0.89s
feat_buffer time: IO load: 1.168s 异步阻塞: 0.000s presample and analyze: 0.440s 预采样: 0.000s, 预采样负采样:0.090s              记忆刷入和更新:0.253s 纯刷入时间:0.000s 负采样分析: 0.095s
平均每个batch用时0.02185s, 预计epoch时间: 59.895s
run batch2000total time: 45.44s,presample: 2.47s, sample: 1.12s, prep time: 10.45s, gen block: 4.31s, feat input: 2.40s, model run: 7.57s,                    loss and opt: 22.28s, update mem: 1.31s update mailbox: 1.73s
feat_buffer time: IO load: 1.967s 异步阻塞: 0.001s presample and analyze: 0.494s 预采样: 0.000s, 预采样负采样:0.143s              记忆刷入和更新:0.253s 纯刷入时间:0.000s 负采样分析: 0.095s
total loop use time: 62.1056
run batch2741total time: 61.64s,presample: 3.12s, sample: 1.52s, prep time: 14.21s, gen block: 5.86s, feat input: 3.27s, model run: 10.29s,               loss and opt: 30.39s, update mem: 1.78s update mailbox: 2.35s
	train loss:2843907.0596  val ap:0.955106  val auc:0.949295, eval time: 24.90
Loading model at epoch 8...
	test AP:0.895429  test AUC:0.877284
训练完成，退出子进程
