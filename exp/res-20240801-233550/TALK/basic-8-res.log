训练配置: {'use_valid_edge': False, 'use_ayscn_prefetch': True, 'pre_sample_size': 600000, 'part_neg_sample': False}
Sent: init_feats
Received: None
Epoch 0:
IO load: 0.000s presample and analyze: 0.000s 预采样: 0.000s, 预采样负采样:0.000s
第一个块的加载时间: 1.604s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.267s 异步阻塞: 0.000s presample and analyze: 1.353s 预采样: 0.000s, 预采样负采样:0.035s              记忆刷入和更新:0.258s 纯刷入时间:0.000s 负采样分析: 1.059s
平均每个batch用时0.02457s, 预计epoch时间: 67.360s
run batch1000total time: 24.57s,presample: 2.25s, sample: 0.55s, prep time: 5.14s, gen block: 2.13s, feat input: 1.20s, model run: 4.73s,                    loss and opt: 11.15s, update mem: 0.64s update mailbox: 0.84s
feat_buffer time: IO load: 0.840s 异步阻塞: 0.000s presample and analyze: 1.406s 预采样: 0.000s, 预采样负采样:0.086s              记忆刷入和更新:0.258s 纯刷入时间:0.000s 负采样分析: 1.059s
平均每个batch用时0.02160s, 预计epoch时间: 59.205s
run batch2000total time: 46.16s,presample: 2.91s, sample: 1.09s, prep time: 10.21s, gen block: 4.22s, feat input: 2.39s, model run: 8.40s,                    loss and opt: 22.08s, update mem: 1.26s update mailbox: 1.66s
feat_buffer time: IO load: 1.441s 异步阻塞: 0.001s presample and analyze: 1.459s 预采样: 0.000s, 预采样负采样:0.138s              记忆刷入和更新:0.258s 纯刷入时间:0.000s 负采样分析: 1.059s
total loop use time: 62.6851
run batch2741total time: 62.29s,presample: 3.40s, sample: 1.49s, prep time: 13.99s, gen block: 5.78s, feat input: 3.28s, model run: 11.14s,               loss and opt: 30.23s, update mem: 1.73s update mailbox: 2.28s
	train loss:3587391.0367  val ap:0.945741  val auc:0.940096, eval time: 28.79
Epoch 1:
IO load: 1.908s presample and analyze: 1.481s 预采样: 0.000s, 预采样负采样:0.159s
第一个块的加载时间: 0.753s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.354s 异步阻塞: 0.000s presample and analyze: 0.416s 预采样: 0.000s, 预采样负采样:0.034s              记忆刷入和更新:0.275s 纯刷入时间:0.000s 负采样分析: 0.107s
平均每个batch用时0.02348s, 预计epoch时间: 64.369s
run batch1000total time: 23.48s,presample: 1.57s, sample: 0.56s, prep time: 5.25s, gen block: 2.17s, feat input: 1.21s, model run: 3.87s,                    loss and opt: 11.43s, update mem: 0.65s update mailbox: 0.87s
feat_buffer time: IO load: 1.093s 异步阻塞: 0.000s presample and analyze: 0.470s 预采样: 0.000s, 预采样负采样:0.086s              记忆刷入和更新:0.275s 纯刷入时间:0.000s 负采样分析: 0.107s
平均每个batch用时0.02274s, 预计epoch时间: 62.341s
run batch2000total time: 46.22s,presample: 2.41s, sample: 1.13s, prep time: 10.56s, gen block: 4.36s, feat input: 2.44s, model run: 7.76s,                    loss and opt: 22.79s, update mem: 1.31s update mailbox: 1.74s
feat_buffer time: IO load: 1.882s 异步阻塞: 0.001s presample and analyze: 0.523s 预采样: 0.000s, 预采样负采样:0.138s              记忆刷入和更新:0.275s 纯刷入时间:0.000s 负采样分析: 0.107s
total loop use time: 63.2229
run batch2741total time: 62.77s,presample: 3.06s, sample: 1.54s, prep time: 14.43s, gen block: 5.96s, feat input: 3.33s, model run: 10.57s,               loss and opt: 31.05s, update mem: 1.79s update mailbox: 2.38s
	train loss:3133246.5215  val ap:0.950337  val auc:0.944056, eval time: 30.66
Epoch 2:
IO load: 2.503s presample and analyze: 0.547s 预采样: 0.000s, 预采样负采样:0.161s
第一个块的加载时间: 0.672s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.321s 异步阻塞: 0.000s presample and analyze: 0.368s 预采样: 0.000s, 预采样负采样:0.032s              记忆刷入和更新:0.246s 纯刷入时间:0.000s 负采样分析: 0.090s
平均每个batch用时0.02278s, 预计epoch时间: 62.447s
run batch1000total time: 22.78s,presample: 1.29s, sample: 0.56s, prep time: 5.18s, gen block: 2.14s, feat input: 1.20s, model run: 3.79s,                    loss and opt: 11.18s, update mem: 0.64s update mailbox: 0.85s
feat_buffer time: IO load: 0.860s 异步阻塞: 0.000s presample and analyze: 0.420s 预采样: 0.000s, 预采样负采样:0.083s              记忆刷入和更新:0.246s 纯刷入时间:0.000s 负采样分析: 0.090s
平均每个batch用时0.02214s, 预计epoch时间: 60.708s
run batch2000total time: 44.92s,presample: 1.91s, sample: 1.12s, prep time: 10.41s, gen block: 4.30s, feat input: 2.43s, model run: 7.60s,                    loss and opt: 22.34s, update mem: 1.28s update mailbox: 1.71s
feat_buffer time: IO load: 1.423s 异步阻塞: 0.001s presample and analyze: 0.473s 预采样: 0.000s, 预采样负采样:0.134s              记忆刷入和更新:0.246s 纯刷入时间:0.000s 负采样分析: 0.090s
total loop use time: 61.8495
run batch2741total time: 61.40s,presample: 2.40s, sample: 1.53s, prep time: 14.30s, gen block: 5.90s, feat input: 3.33s, model run: 10.44s,               loss and opt: 30.61s, update mem: 1.76s update mailbox: 2.34s
	train loss:3031349.9216  val ap:0.951648  val auc:0.945825, eval time: 29.27
Epoch 3:
IO load: 1.891s presample and analyze: 0.495s 预采样: 0.000s, 预采样负采样:0.155s
第一个块的加载时间: 0.674s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.295s 异步阻塞: 0.000s presample and analyze: 0.394s 预采样: 0.000s, 预采样负采样:0.027s              记忆刷入和更新:0.278s 纯刷入时间:0.000s 负采样分析: 0.088s
平均每个batch用时0.02309s, 预计epoch时间: 63.298s
run batch1000total time: 23.09s,presample: 1.47s, sample: 0.55s, prep time: 5.19s, gen block: 2.15s, feat input: 1.20s, model run: 3.78s,                    loss and opt: 11.32s, update mem: 0.65s update mailbox: 0.85s
feat_buffer time: IO load: 1.018s 异步阻塞: 0.000s presample and analyze: 0.444s 预采样: 0.000s, 预采样负采样:0.076s              记忆刷入和更新:0.278s 纯刷入时间:0.000s 负采样分析: 0.088s
平均每个batch用时0.02256s, 预计epoch时间: 61.859s
run batch2000total time: 45.65s,presample: 2.30s, sample: 1.11s, prep time: 10.44s, gen block: 4.31s, feat input: 2.42s, model run: 7.61s,                    loss and opt: 22.65s, update mem: 1.30s update mailbox: 1.72s
feat_buffer time: IO load: 1.794s 异步阻塞: 0.001s presample and analyze: 0.498s 预采样: 0.000s, 预采样负采样:0.128s              记忆刷入和更新:0.278s 纯刷入时间:0.000s 负采样分析: 0.088s
total loop use time: 62.5288
run batch2741total time: 62.11s,presample: 2.94s, sample: 1.51s, prep time: 14.27s, gen block: 5.89s, feat input: 3.32s, model run: 10.40s,               loss and opt: 30.89s, update mem: 1.78s update mailbox: 2.34s
	train loss:2997003.5195  val ap:0.952042  val auc:0.945840, eval time: 29.08
Epoch 4:
IO load: 2.404s presample and analyze: 0.520s 预采样: 0.000s, 预采样负采样:0.150s
第一个块的加载时间: 0.723s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.384s 异步阻塞: 0.000s presample and analyze: 0.356s 预采样: 0.000s, 预采样负采样:0.033s              记忆刷入和更新:0.240s 纯刷入时间:0.000s 负采样分析: 0.083s
平均每个batch用时0.02261s, 预计epoch时间: 61.996s
run batch1000total time: 22.61s,presample: 1.54s, sample: 0.54s, prep time: 5.08s, gen block: 2.09s, feat input: 1.18s, model run: 3.70s,                    loss and opt: 11.01s, update mem: 0.64s update mailbox: 0.83s
feat_buffer time: IO load: 1.124s 异步阻塞: 0.000s presample and analyze: 0.409s 预采样: 0.000s, 预采样负采样:0.085s              记忆刷入和更新:0.240s 纯刷入时间:0.000s 负采样分析: 0.083s
平均每个batch用时0.02215s, 预计epoch时间: 60.714s
run batch2000total time: 44.76s,presample: 2.38s, sample: 1.09s, prep time: 10.23s, gen block: 4.22s, feat input: 2.38s, model run: 7.43s,                    loss and opt: 22.13s, update mem: 1.29s update mailbox: 1.68s
feat_buffer time: IO load: 1.913s 异步阻塞: 0.001s presample and analyze: 0.463s 预采样: 0.000s, 预采样负采样:0.137s              记忆刷入和更新:0.240s 纯刷入时间:0.000s 负采样分析: 0.083s
total loop use time: 61.6683
run batch2741total time: 61.21s,presample: 3.03s, sample: 1.50s, prep time: 14.07s, gen block: 5.80s, feat input: 3.27s, model run: 10.21s,               loss and opt: 30.34s, update mem: 1.76s update mailbox: 2.31s
	train loss:2966336.0852  val ap:0.951523  val auc:0.945329, eval time: 27.27
Epoch 5:
IO load: 2.531s presample and analyze: 0.486s 预采样: 0.000s, 预采样负采样:0.159s
第一个块的加载时间: 0.616s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.280s 异步阻塞: 0.000s presample and analyze: 0.352s 预采样: 0.000s, 预采样负采样:0.028s              记忆刷入和更新:0.242s 纯刷入时间:0.000s 负采样分析: 0.081s
平均每个batch用时0.02251s, 预计epoch时间: 61.713s
run batch1000total time: 22.51s,presample: 1.25s, sample: 0.55s, prep time: 5.12s, gen block: 2.11s, feat input: 1.20s, model run: 3.74s,                    loss and opt: 11.09s, update mem: 0.63s update mailbox: 0.84s
feat_buffer time: IO load: 0.838s 异步阻塞: 0.000s presample and analyze: 0.406s 预采样: 0.000s, 预采样负采样:0.081s              记忆刷入和更新:0.242s 纯刷入时间:0.000s 负采样分析: 0.081s
平均每个batch用时0.02208s, 预计epoch时间: 60.523s
run batch2000total time: 44.58s,presample: 1.90s, sample: 1.10s, prep time: 10.29s, gen block: 4.24s, feat input: 2.40s, model run: 7.56s,                    loss and opt: 22.22s, update mem: 1.27s update mailbox: 1.69s
feat_buffer time: IO load: 1.430s 异步阻塞: 0.001s presample and analyze: 0.460s 预采样: 0.000s, 预采样负采样:0.134s              记忆刷入和更新:0.242s 纯刷入时间:0.000s 负采样分析: 0.081s
total loop use time: 61.1133
run batch2741total time: 60.71s,presample: 2.39s, sample: 1.51s, prep time: 14.06s, gen block: 5.80s, feat input: 3.28s, model run: 10.42s,               loss and opt: 30.26s, update mem: 1.73s update mailbox: 2.30s
	train loss:2929319.4292  val ap:0.954180  val auc:0.948182, eval time: 31.90
Epoch 6:
IO load: 1.897s presample and analyze: 0.483s 预采样: 0.000s, 预采样负采样:0.156s
第一个块的加载时间: 0.816s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.422s 异步阻塞: 0.000s presample and analyze: 0.412s 预采样: 0.000s, 预采样负采样:0.036s              记忆刷入和更新:0.279s 纯刷入时间:0.000s 负采样分析: 0.096s
平均每个batch用时0.02298s, 预计epoch时间: 62.993s
run batch1000total time: 22.98s,presample: 1.44s, sample: 0.56s, prep time: 5.22s, gen block: 2.16s, feat input: 1.22s, model run: 3.81s,                    loss and opt: 11.18s, update mem: 0.64s update mailbox: 0.85s
feat_buffer time: IO load: 0.973s 异步阻塞: 0.000s presample and analyze: 0.463s 预采样: 0.000s, 预采样负采样:0.086s              记忆刷入和更新:0.279s 纯刷入时间:0.000s 负采样分析: 0.096s
平均每个batch用时0.02207s, 预计epoch时间: 60.496s
run batch2000total time: 45.04s,presample: 2.10s, sample: 1.12s, prep time: 10.42s, gen block: 4.31s, feat input: 2.44s, model run: 7.60s,                    loss and opt: 22.28s, update mem: 1.28s update mailbox: 1.70s
feat_buffer time: IO load: 1.576s 异步阻塞: 0.001s presample and analyze: 0.516s 预采样: 0.000s, 预采样负采样:0.138s              记忆刷入和更新:0.279s 纯刷入时间:0.000s 负采样分析: 0.096s
total loop use time: 61.9330
run batch2741total time: 61.46s,presample: 2.61s, sample: 1.53s, prep time: 14.29s, gen block: 5.90s, feat input: 3.35s, model run: 10.43s,               loss and opt: 30.52s, update mem: 1.76s update mailbox: 2.32s
	train loss:2913482.0955  val ap:0.952450  val auc:0.946359, eval time: 26.78
Epoch 7:
IO load: 2.059s presample and analyze: 0.540s 预采样: 0.000s, 预采样负采样:0.160s
第一个块的加载时间: 0.621s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.272s 异步阻塞: 0.000s presample and analyze: 0.364s 预采样: 0.000s, 预采样负采样:0.027s              记忆刷入和更新:0.252s 纯刷入时间:0.000s 负采样分析: 0.084s
平均每个batch用时0.02189s, 预计epoch时间: 60.017s
run batch1000total time: 21.89s,presample: 1.26s, sample: 0.53s, prep time: 5.01s, gen block: 2.08s, feat input: 1.18s, model run: 3.62s,                    loss and opt: 10.74s, update mem: 0.61s update mailbox: 0.81s
feat_buffer time: IO load: 0.839s 异步阻塞: 0.000s presample and analyze: 0.417s 预采样: 0.000s, 预采样负采样:0.079s              记忆刷入和更新:0.252s 纯刷入时间:0.000s 负采样分析: 0.084s
平均每个batch用时0.02114s, 预计epoch时间: 57.956s
run batch2000total time: 43.03s,presample: 1.92s, sample: 1.07s, prep time: 10.01s, gen block: 4.14s, feat input: 2.36s, model run: 7.27s,                    loss and opt: 21.29s, update mem: 1.23s update mailbox: 1.63s
feat_buffer time: IO load: 1.443s 异步阻塞: 0.001s presample and analyze: 0.470s 预采样: 0.000s, 预采样负采样:0.130s              记忆刷入和更新:0.252s 纯刷入时间:0.000s 负采样分析: 0.084s
total loop use time: 59.1211
run batch2741total time: 58.72s,presample: 2.42s, sample: 1.46s, prep time: 13.71s, gen block: 5.68s, feat input: 3.23s, model run: 9.96s,               loss and opt: 29.16s, update mem: 1.68s update mailbox: 2.22s
	train loss:2870825.3683  val ap:0.951704  val auc:0.945652, eval time: 25.89
Epoch 8:
IO load: 1.917s presample and analyze: 0.492s 预采样: 0.000s, 预采样负采样:0.152s
第一个块的加载时间: 0.679s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.323s 异步阻塞: 0.000s presample and analyze: 0.372s 预采样: 0.000s, 预采样负采样:0.033s              记忆刷入和更新:0.254s 纯刷入时间:0.000s 负采样分析: 0.085s
平均每个batch用时0.02236s, 预计epoch时间: 61.303s
run batch1000total time: 22.36s,presample: 1.31s, sample: 0.55s, prep time: 5.12s, gen block: 2.12s, feat input: 1.20s, model run: 3.76s,                    loss and opt: 10.86s, update mem: 0.63s update mailbox: 0.84s
feat_buffer time: IO load: 0.883s 异步阻塞: 0.000s presample and analyze: 0.425s 预采样: 0.000s, 预采样负采样:0.084s              记忆刷入和更新:0.254s 纯刷入时间:0.000s 负采样分析: 0.085s
平均每个batch用时0.02155s, 预计epoch时间: 59.081s
run batch2000total time: 43.91s,presample: 1.96s, sample: 1.09s, prep time: 10.19s, gen block: 4.21s, feat input: 2.39s, model run: 7.45s,                    loss and opt: 21.73s, update mem: 1.25s update mailbox: 1.66s
feat_buffer time: IO load: 1.470s 异步阻塞: 0.001s presample and analyze: 0.477s 预采样: 0.000s, 预采样负采样:0.135s              记忆刷入和更新:0.254s 纯刷入时间:0.000s 负采样分析: 0.085s
total loop use time: 60.4939
run batch2741total time: 60.06s,presample: 2.43s, sample: 1.49s, prep time: 13.97s, gen block: 5.76s, feat input: 3.28s, model run: 10.19s,               loss and opt: 29.94s, update mem: 1.72s update mailbox: 2.28s
	train loss:2875026.2807  val ap:0.953088  val auc:0.946797, eval time: 29.55
Epoch 9:
IO load: 1.921s presample and analyze: 0.499s 预采样: 0.000s, 预采样负采样:0.156s
第一个块的加载时间: 0.676s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, prep time: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s,                    loss and opt: 0.00s, update mem: 0.00s update mailbox: 0.00s
feat_buffer time: IO load: 0.318s 异步阻塞: 0.000s presample and analyze: 0.376s 预采样: 0.000s, 预采样负采样:0.035s              记忆刷入和更新:0.254s 纯刷入时间:0.000s 负采样分析: 0.086s
平均每个batch用时0.02268s, 预计epoch时间: 62.184s
run batch1000total time: 22.68s,presample: 1.31s, sample: 0.55s, prep time: 5.13s, gen block: 2.13s, feat input: 1.18s, model run: 3.74s,                    loss and opt: 11.20s, update mem: 0.64s update mailbox: 0.84s
feat_buffer time: IO load: 0.877s 异步阻塞: 0.000s presample and analyze: 0.427s 预采样: 0.000s, 预采样负采样:0.085s              记忆刷入和更新:0.254s 纯刷入时间:0.000s 负采样分析: 0.086s
平均每个batch用时0.02205s, 预计epoch时间: 60.462s
run batch2000total time: 44.73s,presample: 1.94s, sample: 1.11s, prep time: 10.32s, gen block: 4.27s, feat input: 2.40s, model run: 7.51s,                    loss and opt: 22.35s, update mem: 1.28s update mailbox: 1.69s
feat_buffer time: IO load: 1.451s 异步阻塞: 0.001s presample and analyze: 0.479s 预采样: 0.000s, 预采样负采样:0.136s              记忆刷入和更新:0.254s 纯刷入时间:0.000s 负采样分析: 0.086s
total loop use time: 61.3682
run batch2741total time: 60.96s,presample: 2.41s, sample: 1.51s, prep time: 14.14s, gen block: 5.85s, feat input: 3.30s, model run: 10.30s,               loss and opt: 30.54s, update mem: 1.75s update mailbox: 2.31s
	train loss:2840898.0327  val ap:0.947670  val auc:0.941095, eval time: 28.04
Loading model at epoch 5...
	test AP:0.833734  test AUC:0.823825
训练完成，退出子进程
