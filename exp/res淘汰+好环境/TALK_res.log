Sent: init_feats
Received: None
already part feat
Epoch 0:
IO load: 0.000s presample and analyze: 0.000s 预采样: 0.000s, 预采样负采样:0.000s
cur batch: 0, start pre sample and analyze...
第一个块的加载时间: 2.561s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s, loss and opt: 0.00s, update mem: 0.00s
feat_buffer time: IO load: 0.300s presample and analyze: 2.288s 预采样: 0.000s, 预采样负采样:0.181s              记忆刷入和更新:0.288s 纯刷入时间:0.000s 负采样分析: 1.818s
cur batch: 300, start pre sample and analyze...
cur batch: 600, start pre sample and analyze...
cur batch: 900, start pre sample and analyze...
平均每个batch用时0.02505s, 预计epoch时间: 68.665s
run batch1000total time: 25.05s,presample: 3.36s, sample: 0.59s, gen block: 2.33s, feat input: 1.45s, model run: 5.13s, loss and opt: 9.26s, update mem: 2.23s
feat_buffer time: IO load: 1.006s presample and analyze: 2.355s 预采样: 0.000s, 预采样负采样:0.247s              记忆刷入和更新:0.288s 纯刷入时间:0.000s 负采样分析: 1.818s
cur batch: 1200, start pre sample and analyze...
cur batch: 1500, start pre sample and analyze...
cur batch: 1800, start pre sample and analyze...
平均每个batch用时0.02174s, 预计epoch时间: 59.595s
run batch2000total time: 46.78s,presample: 4.22s, sample: 1.18s, gen block: 4.65s, feat input: 2.91s, model run: 9.43s, loss and opt: 18.57s, update mem: 4.46s
feat_buffer time: IO load: 1.785s presample and analyze: 2.422s 预采样: 0.000s, 预采样负采样:0.313s              记忆刷入和更新:0.288s 纯刷入时间:0.000s 负采样分析: 1.818s
cur batch: 2100, start pre sample and analyze...
cur batch: 2400, start pre sample and analyze...
cur batch: 2700, start pre sample and analyze...
total loop use time: 63.1822
run batch2741total time: 62.75s,presample: 4.93s, sample: 1.61s, gen block: 6.36s, feat input: 3.98s, model run: 12.55s, loss and opt: 25.31s, update mem: 6.12s
Epoch 1:
IO load: 2.369s presample and analyze: 2.545s 预采样: 0.000s, 预采样负采样:0.339s
cur batch: 0, start pre sample and analyze...
第一个块的加载时间: 0.831s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s, loss and opt: 0.00s, update mem: 0.00s
feat_buffer time: IO load: 0.293s presample and analyze: 0.564s 预采样: 0.000s, 预采样负采样:0.043s              记忆刷入和更新:0.282s 纯刷入时间:0.000s 负采样分析: 0.238s
cur batch: 300, start pre sample and analyze...
cur batch: 600, start pre sample and analyze...
cur batch: 900, start pre sample and analyze...
平均每个batch用时0.02252s, 预计epoch时间: 61.731s
run batch1000total time: 22.52s,presample: 1.67s, sample: 0.58s, gen block: 2.31s, feat input: 1.44s, model run: 4.28s, loss and opt: 9.30s, update mem: 2.26s
feat_buffer time: IO load: 1.034s presample and analyze: 0.632s 预采样: 0.000s, 预采样负采样:0.110s              记忆刷入和更新:0.282s 纯刷入时间:0.000s 负采样分析: 0.238s
cur batch: 1200, start pre sample and analyze...
cur batch: 1500, start pre sample and analyze...
cur batch: 1800, start pre sample and analyze...
平均每个batch用时0.02181s, 预计epoch时间: 59.806s
run batch2000total time: 44.33s,presample: 2.53s, sample: 1.17s, gen block: 4.64s, feat input: 2.90s, model run: 8.56s, loss and opt: 18.66s, update mem: 4.50s
feat_buffer time: IO load: 1.820s presample and analyze: 0.703s 预采样: 0.000s, 预采样负采样:0.179s              记忆刷入和更新:0.282s 纯刷入时间:0.000s 负采样分析: 0.238s
cur batch: 2100, start pre sample and analyze...
cur batch: 2400, start pre sample and analyze...
cur batch: 2700, start pre sample and analyze...
total loop use time: 60.6235
run batch2741total time: 60.17s,presample: 3.14s, sample: 1.60s, gen block: 6.34s, feat input: 3.97s, model run: 11.70s, loss and opt: 25.40s, update mem: 6.14s
Epoch 2:
IO load: 2.394s presample and analyze: 0.730s 预采样: 0.000s, 预采样负采样:0.206s
cur batch: 0, start pre sample and analyze...
第一个块的加载时间: 0.836s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s, loss and opt: 0.00s, update mem: 0.00s
feat_buffer time: IO load: 0.300s presample and analyze: 0.555s 预采样: 0.000s, 预采样负采样:0.036s              记忆刷入和更新:0.284s 纯刷入时间:0.000s 负采样分析: 0.234s
cur batch: 300, start pre sample and analyze...
cur batch: 600, start pre sample and analyze...
cur batch: 900, start pre sample and analyze...
平均每个batch用时0.02243s, 预计epoch时间: 61.502s
run batch1000total time: 22.43s,presample: 1.65s, sample: 0.59s, gen block: 2.33s, feat input: 1.44s, model run: 4.24s, loss and opt: 9.24s, update mem: 2.25s
feat_buffer time: IO load: 1.021s presample and analyze: 0.620s 预采样: 0.000s, 预采样负采样:0.100s              记忆刷入和更新:0.284s 纯刷入时间:0.000s 负采样分析: 0.234s
cur batch: 1200, start pre sample and analyze...
cur batch: 1500, start pre sample and analyze...
cur batch: 1800, start pre sample and analyze...
平均每个batch用时0.02145s, 预计epoch时间: 58.802s
run batch2000total time: 43.88s,presample: 2.50s, sample: 1.18s, gen block: 4.63s, feat input: 2.87s, model run: 8.44s, loss and opt: 18.39s, update mem: 4.50s
feat_buffer time: IO load: 1.804s presample and analyze: 0.691s 预采样: 0.000s, 预采样负采样:0.170s              记忆刷入和更新:0.284s 纯刷入时间:0.000s 负采样分析: 0.234s
cur batch: 2100, start pre sample and analyze...
cur batch: 2400, start pre sample and analyze...
cur batch: 2700, start pre sample and analyze...
total loop use time: 60.2956
run batch2741total time: 59.85s,presample: 3.14s, sample: 1.61s, gen block: 6.33s, feat input: 3.94s, model run: 11.55s, loss and opt: 25.27s, update mem: 6.13s
Epoch 3:
IO load: 2.413s presample and analyze: 0.720s 预采样: 0.000s, 预采样负采样:0.198s
cur batch: 0, start pre sample and analyze...
第一个块的加载时间: 0.919s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s, loss and opt: 0.00s, update mem: 0.00s
feat_buffer time: IO load: 0.301s presample and analyze: 0.640s 预采样: 0.000s, 预采样负采样:0.039s              记忆刷入和更新:0.365s 纯刷入时间:0.000s 负采样分析: 0.235s
cur batch: 300, start pre sample and analyze...
cur batch: 600, start pre sample and analyze...
cur batch: 900, start pre sample and analyze...
平均每个batch用时0.02273s, 预计epoch时间: 62.310s
run batch1000total time: 22.73s,presample: 1.72s, sample: 0.59s, gen block: 2.35s, feat input: 1.46s, model run: 4.30s, loss and opt: 9.35s, update mem: 2.25s
feat_buffer time: IO load: 1.015s presample and analyze: 0.705s 预采样: 0.000s, 预采样负采样:0.103s              记忆刷入和更新:0.365s 纯刷入时间:0.000s 负采样分析: 0.235s
cur batch: 1200, start pre sample and analyze...
cur batch: 1500, start pre sample and analyze...
cur batch: 1800, start pre sample and analyze...
平均每个batch用时0.02165s, 预计epoch时间: 59.357s
run batch2000total time: 44.38s,presample: 2.55s, sample: 1.18s, gen block: 4.67s, feat input: 2.91s, model run: 8.57s, loss and opt: 18.62s, update mem: 4.48s
feat_buffer time: IO load: 1.772s presample and analyze: 0.770s 预采样: 0.000s, 预采样负采样:0.166s              记忆刷入和更新:0.365s 纯刷入时间:0.000s 负采样分析: 0.235s
cur batch: 2100, start pre sample and analyze...
cur batch: 2400, start pre sample and analyze...
cur batch: 2700, start pre sample and analyze...
total loop use time: 60.7010
run batch2741total time: 60.25s,presample: 3.19s, sample: 1.61s, gen block: 6.37s, feat input: 3.98s, model run: 11.66s, loss and opt: 25.43s, update mem: 6.12s
Epoch 4:
IO load: 2.379s presample and analyze: 0.797s 预采样: 0.000s, 预采样负采样:0.193s
cur batch: 0, start pre sample and analyze...
第一个块的加载时间: 0.840s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s, loss and opt: 0.00s, update mem: 0.00s
feat_buffer time: IO load: 0.300s presample and analyze: 0.562s 预采样: 0.000s, 预采样负采样:0.039s              记忆刷入和更新:0.292s 纯刷入时间:0.000s 负采样分析: 0.230s
cur batch: 300, start pre sample and analyze...
cur batch: 600, start pre sample and analyze...
cur batch: 900, start pre sample and analyze...
平均每个batch用时0.02243s, 预计epoch时间: 61.506s
run batch1000total time: 22.43s,presample: 1.66s, sample: 0.59s, gen block: 2.32s, feat input: 1.44s, model run: 4.23s, loss and opt: 9.27s, update mem: 2.25s
feat_buffer time: IO load: 1.030s presample and analyze: 0.627s 预采样: 0.000s, 预采样负采样:0.103s              记忆刷入和更新:0.292s 纯刷入时间:0.000s 负采样分析: 0.230s
cur batch: 1200, start pre sample and analyze...
cur batch: 1500, start pre sample and analyze...
cur batch: 1800, start pre sample and analyze...
平均每个batch用时0.02135s, 预计epoch时间: 58.527s
run batch2000total time: 43.78s,presample: 2.49s, sample: 1.17s, gen block: 4.61s, feat input: 2.87s, model run: 8.44s, loss and opt: 18.35s, update mem: 4.48s
feat_buffer time: IO load: 1.794s presample and analyze: 0.692s 预采样: 0.000s, 预采样负采样:0.166s              记忆刷入和更新:0.292s 纯刷入时间:0.000s 负采样分析: 0.230s
cur batch: 2100, start pre sample and analyze...
cur batch: 2400, start pre sample and analyze...
cur batch: 2700, start pre sample and analyze...
total loop use time: 60.2041
run batch2741total time: 59.75s,presample: 3.14s, sample: 1.60s, gen block: 6.31s, feat input: 3.94s, model run: 11.56s, loss and opt: 25.19s, update mem: 6.14s
Loading model at epoch 0...
训练完成，退出子进程
[W CudaIPCTypes.cpp:15] Producer process has been terminated before all shared CUDA tensors released. See Note [Sharing CUDA tensors]
