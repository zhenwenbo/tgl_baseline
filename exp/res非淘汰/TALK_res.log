Sent: init_feats
Received: None
already part feat
Epoch 0:
IO load: 0.000s presample and analyze: 0.000s 预采样: 0.000s, 预采样负采样:0.000s
cur batch: 0, start pre sample and analyze...
第一个块的加载时间: 2.543s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s, loss and opt: 0.00s, update mem: 0.00s
feat_buffer time: IO load: 0.382s presample and analyze: 2.193s 预采样: 0.000s, 预采样负采样:0.185s              记忆刷入和更新:0.278s 纯刷入时间:0.000s 负采样分析: 1.729s
cur batch: 300, start pre sample and analyze...
cur batch: 600, start pre sample and analyze...
cur batch: 900, start pre sample and analyze...
平均每个batch用时0.02543s, 预计epoch时间: 69.724s
run batch1000total time: 25.43s,presample: 3.39s, sample: 0.60s, gen block: 2.36s, feat input: 1.49s, model run: 5.12s, loss and opt: 9.53s, update mem: 2.26s
feat_buffer time: IO load: 1.115s presample and analyze: 2.266s 预采样: 0.000s, 预采样负采样:0.257s              记忆刷入和更新:0.278s 纯刷入时间:0.000s 负采样分析: 1.729s
cur batch: 1200, start pre sample and analyze...
cur batch: 1500, start pre sample and analyze...
cur batch: 1800, start pre sample and analyze...
平均每个batch用时0.02198s, 预计epoch时间: 60.267s
run batch2000total time: 47.41s,presample: 4.24s, sample: 1.19s, gen block: 4.68s, feat input: 2.97s, model run: 9.29s, loss and opt: 19.14s, update mem: 4.53s
feat_buffer time: IO load: 1.875s presample and analyze: 2.352s 预采样: 0.000s, 预采样负采样:0.326s              记忆刷入和更新:0.278s 纯刷入时间:0.000s 负采样分析: 1.729s
cur batch: 2100, start pre sample and analyze...
cur batch: 2400, start pre sample and analyze...
cur batch: 2700, start pre sample and analyze...
total loop use time: 64.2891
run batch2741total time: 63.86s,presample: 4.89s, sample: 1.64s, gen block: 6.44s, feat input: 4.10s, model run: 12.43s, loss and opt: 26.30s, update mem: 6.19s
Epoch 1:
IO load: 2.496s presample and analyze: 2.383s 预采样: 0.000s, 预采样负采样:0.355s
cur batch: 0, start pre sample and analyze...
第一个块的加载时间: 0.685s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s, loss and opt: 0.00s, update mem: 0.00s
feat_buffer time: IO load: 0.302s presample and analyze: 0.402s 预采样: 0.000s, 预采样负采样:0.036s              记忆刷入和更新:0.270s 纯刷入时间:0.000s 负采样分析: 0.095s
cur batch: 300, start pre sample and analyze...
cur batch: 600, start pre sample and analyze...
cur batch: 900, start pre sample and analyze...
平均每个batch用时0.02299s, 预计epoch时间: 63.019s
run batch1000total time: 22.99s,presample: 1.51s, sample: 0.61s, gen block: 2.37s, feat input: 1.50s, model run: 4.27s, loss and opt: 9.74s, update mem: 2.30s
feat_buffer time: IO load: 1.031s presample and analyze: 0.470s 预采样: 0.000s, 预采样负采样:0.103s              记忆刷入和更新:0.270s 纯刷入时间:0.000s 负采样分析: 0.095s
cur batch: 1200, start pre sample and analyze...
cur batch: 1500, start pre sample and analyze...
cur batch: 1800, start pre sample and analyze...
平均每个batch用时0.02213s, 预计epoch时间: 60.673s
run batch2000total time: 45.12s,presample: 2.37s, sample: 1.21s, gen block: 4.72s, feat input: 2.98s, model run: 8.48s, loss and opt: 19.42s, update mem: 4.56s
feat_buffer time: IO load: 1.816s presample and analyze: 0.541s 预采样: 0.000s, 预采样负采样:0.172s              记忆刷入和更新:0.270s 纯刷入时间:0.000s 负采样分析: 0.095s
cur batch: 2100, start pre sample and analyze...
cur batch: 2400, start pre sample and analyze...
cur batch: 2700, start pre sample and analyze...
total loop use time: 61.3999
run batch2741total time: 60.94s,presample: 3.00s, sample: 1.64s, gen block: 6.38s, feat input: 4.06s, model run: 11.51s, loss and opt: 26.29s, update mem: 6.20s
Epoch 2:
IO load: 2.420s presample and analyze: 0.568s 预采样: 0.000s, 预采样负采样:0.199s
cur batch: 0, start pre sample and analyze...
第一个块的加载时间: 0.883s
平均每个batch用时0.00000s, 预计epoch时间: 0.000s
run batch0total time: 0.00s,presample: 0.00s, sample: 0.00s, gen block: 0.00s, feat input: 0.00s, model run: 0.00s, loss and opt: 0.00s, update mem: 0.00s
feat_buffer time: IO load: 0.302s presample and analyze: 0.607s 预采样: 0.000s, 预采样负采样:0.044s              记忆刷入和更新:0.297s 纯刷入时间:0.000s 负采样分析: 0.266s
cur batch: 300, start pre sample and analyze...
cur batch: 600, start pre sample and analyze...
cur batch: 900, start pre sample and analyze...
平均每个batch用时0.02329s, 预计epoch时间: 63.861s
run batch1000total time: 23.29s,presample: 1.68s, sample: 0.61s, gen block: 2.41s, feat input: 1.50s, model run: 4.30s, loss and opt: 9.81s, update mem: 2.28s
feat_buffer time: IO load: 1.007s presample and analyze: 0.670s 预采样: 0.000s, 预采样负采样:0.105s              记忆刷入和更新:0.297s 纯刷入时间:0.000s 负采样分析: 0.266s
cur batch: 1200, start pre sample and analyze...
cur batch: 1500, start pre sample and analyze...
cur batch: 1800, start pre sample and analyze...
平均每个batch用时0.02268s, 预计epoch时间: 62.189s
run batch2000total time: 45.98s,presample: 2.52s, sample: 1.22s, gen block: 4.81s, feat input: 3.01s, model run: 8.60s, loss and opt: 19.79s, update mem: 4.61s
feat_buffer time: IO load: 1.777s presample and analyze: 0.735s 预采样: 0.000s, 预采样负采样:0.169s              记忆刷入和更新:0.297s 纯刷入时间:0.000s 负采样分析: 0.266s
cur batch: 2100, start pre sample and analyze...
cur batch: 2400, start pre sample and analyze...
cur batch: 2700, start pre sample and analyze...
total loop use time: 62.7923
run batch2741total time: 62.33s,presample: 3.18s, sample: 1.66s, gen block: 6.53s, feat input: 4.11s, model run: 11.72s, loss and opt: 26.96s, update mem: 6.26s
Loading model at epoch 0...
训练完成，退出子进程
[W CudaIPCTypes.cpp:15] Producer process has been terminated before all shared CUDA tensors released. See Note [Sharing CUDA tensors]
